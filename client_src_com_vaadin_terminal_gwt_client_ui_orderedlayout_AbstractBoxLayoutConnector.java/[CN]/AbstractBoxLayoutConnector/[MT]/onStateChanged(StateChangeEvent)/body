{
  super.onStateChanged(stateChangeEvent);
  clickEventHandler.handleEventHandlerRegistration();
  getWidget().setMargin(new MarginInfo(getState().getMarginsBitmask()));
  getWidget().setSpacing(getState().isSpacing());
  hasExpandRatio.clear();
  hasVerticalAlignment.clear();
  hasRelativeHeight.clear();
  needsMeasure.clear();
  boolean equalExpandRatio=getWidget().vertical ? !isUndefinedHeight() : !isUndefinedWidth();
  for (  ComponentConnector child : getChildComponents()) {
    double expandRatio=getState().getChildData().get(child).getExpandRatio();
    if (expandRatio > 0) {
      equalExpandRatio=false;
      break;
    }
  }
  for (  ComponentConnector child : getChildComponents()) {
    Slot slot=getWidget().getSlot(child);
    AlignmentInfo alignment=new AlignmentInfo(getState().getChildData().get(child).getAlignmentBitmask());
    slot.setAlignment(alignment);
    double expandRatio=getState().getChildData().get(child).getExpandRatio();
    if (equalExpandRatio) {
      expandRatio=1;
    }
 else     if (expandRatio == 0) {
      expandRatio=-1;
    }
    slot.setExpandRatio(expandRatio);
    if (alignment.isVerticalCenter() || alignment.isBottom()) {
      hasVerticalAlignment.add(child);
    }
    if (expandRatio > 0) {
      hasExpandRatio.add(child);
    }
  }
  updateAllSlotListeners();
  updateLayoutHeight();
}

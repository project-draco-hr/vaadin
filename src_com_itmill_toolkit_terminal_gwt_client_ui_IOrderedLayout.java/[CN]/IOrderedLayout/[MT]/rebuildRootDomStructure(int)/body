{
  boolean newTableMode=!(orientationMode == ORIENTATION_VERTICAL && width != null);
  if (oldOrientationMode == orientationMode && newTableMode == tableMode) {
    return;
  }
  boolean oldTableMode=tableMode;
  tableMode=newTableMode;
  if (BrowserInfo.get().isIE()) {
    while (true) {
      Element child=DOM.getFirstChild(getElement());
      if (child != null) {
        DOM.removeChild(getElement(),child);
      }
 else {
        break;
      }
    }
  }
  if (tableMode) {
    final String structure="<table cellspacing=\"0\" cellpadding=\"0\"><tbody>" + (orientationMode == ORIENTATION_HORIZONTAL ? "<tr valign=\"top\"></tr>" : "") + "</tbody></table>";
    DOM.setInnerHTML(getElement(),structure);
    root=DOM.getFirstChild(getElement());
    wrappedChildContainer=DOM.getFirstChild(root);
    if (orientationMode == ORIENTATION_HORIZONTAL) {
      wrappedChildContainer=DOM.getFirstChild(wrappedChildContainer);
    }
  }
 else {
    root=wrappedChildContainer=getElement();
    DOM.setInnerHTML(getElement(),"");
  }
  final int currentOrientationMode=orientationMode;
  for (int i=0; i < childWidgetWrappers.size(); i++) {
    WidgetWrapper wr=(WidgetWrapper)childWidgetWrappers.get(i);
    orientationMode=oldOrientationMode;
    tableMode=oldTableMode;
    Element oldWrElement=wr.getElementWrappingWidgetAndCaption();
    orientationMode=currentOrientationMode;
    tableMode=newTableMode;
    String classe=DOM.getElementAttribute(oldWrElement,"class");
    wr.resetRootElement();
    Element newWrElement=wr.getElementWrappingWidgetAndCaption();
    if (classe != null && classe.length() > 0) {
      DOM.setElementAttribute(newWrElement,"class",classe);
    }
    while (DOM.getChildCount(oldWrElement) > 0) {
      Element c=DOM.getFirstChild(oldWrElement);
      DOM.removeChild(oldWrElement,c);
      DOM.appendChild(newWrElement,c);
    }
    DOM.appendChild(wrappedChildContainer,wr.getElement());
  }
  childLayoutsHaveChanged=true;
}

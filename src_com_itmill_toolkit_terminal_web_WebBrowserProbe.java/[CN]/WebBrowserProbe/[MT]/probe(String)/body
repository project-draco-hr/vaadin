{
  WebBrowser res=new WebBrowser();
  if (agent == null)   return res;
  res.setBrowserApplication(agent);
  if (agent.indexOf("Konqueror") >= 0) {
    res.setJavaScriptVersion(WebBrowser.JSCRIPT_5_6);
    res.setJavaEnabled(true);
    res.setFrameSupport(true);
  }
 else   if ((agent.indexOf("Opera 6.") >= 0) || (agent.indexOf("Opera 5.") >= 0) || (agent.indexOf("Opera 4.") >= 0)) {
    res.setJavaScriptVersion(WebBrowser.JAVASCRIPT_1_3);
    res.setJavaEnabled(true);
    res.setFrameSupport(true);
    res.setMarkupVersion(WebBrowser.MARKUP_HTML_4_0);
  }
 else   if (agent.indexOf("Opera 3.") >= 0) {
    res.setJavaScriptVersion(WebBrowser.JAVASCRIPT_1_3);
    res.setJavaEnabled(false);
    res.setFrameSupport(true);
  }
 else   if (agent.indexOf("OmniWeb") >= 0) {
    res.setJavaScriptVersion(WebBrowser.JAVASCRIPT_1_3);
    res.setJavaEnabled(true);
    res.setFrameSupport(true);
  }
 else   if (agent.indexOf("Mosaic") >= 0) {
    res.setJavaScriptVersion(WebBrowser.JAVASCRIPT_1_3);
    res.setJavaEnabled(true);
    res.setFrameSupport(true);
    res.setMarkupVersion(WebBrowser.MARKUP_HTML_2_0);
  }
 else   if (agent.indexOf("Lynx") >= 0) {
    res.setJavaScriptVersion(WebBrowser.JAVASCRIPT_NONE);
    res.setJavaEnabled(false);
    res.setFrameSupport(true);
  }
 else   if (agent.indexOf("MSIE 7.") >= 0) {
    res.setJavaScriptVersion(WebBrowser.JSCRIPT_5_7);
    res.setJavaEnabled(true);
    res.setFrameSupport(true);
    res.setMarkupVersion(WebBrowser.MARKUP_HTML_4_0);
  }
 else   if (agent.indexOf("MSIE 6.") >= 0) {
    res.setJavaScriptVersion(WebBrowser.JSCRIPT_5_6);
    res.setJavaEnabled(true);
    res.setFrameSupport(true);
    res.setMarkupVersion(WebBrowser.MARKUP_HTML_4_0);
  }
 else   if (agent.indexOf("MSIE 5.5") >= 0) {
    res.setJavaScriptVersion(WebBrowser.JSCRIPT_5_5);
    res.setJavaEnabled(true);
    res.setFrameSupport(true);
    res.setMarkupVersion(WebBrowser.MARKUP_HTML_4_0);
  }
 else   if (agent.indexOf("MSIE 5.") >= 0) {
    res.setJavaScriptVersion(WebBrowser.JSCRIPT_5_0);
    res.setJavaEnabled(true);
    res.setFrameSupport(true);
    res.setMarkupVersion(WebBrowser.MARKUP_HTML_4_0);
  }
 else   if (agent.indexOf("MSIE 4.") >= 0) {
    res.setJavaScriptVersion(WebBrowser.JSCRIPT_3_0);
    res.setJavaEnabled(true);
    res.setFrameSupport(true);
    res.setMarkupVersion(WebBrowser.MARKUP_HTML_4_0);
  }
 else   if (agent.indexOf("MSIE 3.") >= 0) {
    res.setJavaScriptVersion(WebBrowser.JSCRIPT_3_0);
    res.setJavaEnabled(true);
    res.setFrameSupport(true);
  }
 else   if (agent.indexOf("MSIE 2.") >= 0) {
    res.setJavaScriptVersion(WebBrowser.JAVASCRIPT_NONE);
    res.setJavaEnabled(false);
    if (agent.indexOf("Mac") >= 0) {
      res.setFrameSupport(true);
    }
 else {
      res.setFrameSupport(false);
    }
  }
 else   if (agent.indexOf("Netscape6") >= 0) {
    res.setJavaScriptVersion(WebBrowser.JAVASCRIPT_1_5);
    res.setJavaEnabled(true);
    res.setFrameSupport(true);
    res.setMarkupVersion(WebBrowser.MARKUP_HTML_4_0);
  }
 else   if ((agent.indexOf("Mozilla/4.06") >= 0) || (agent.indexOf("Mozilla/4.7") >= 0)) {
    res.setJavaScriptVersion(WebBrowser.JAVASCRIPT_1_3);
    res.setJavaEnabled(true);
    res.setFrameSupport(true);
    res.setMarkupVersion(WebBrowser.MARKUP_HTML_4_0);
  }
 else   if (agent.indexOf("Mozilla/4.") >= 0) {
    res.setJavaScriptVersion(WebBrowser.JAVASCRIPT_1_2);
    res.setJavaEnabled(true);
    res.setFrameSupport(true);
  }
 else   if (agent.indexOf("Mozilla/3.") >= 0) {
    res.setJavaScriptVersion(WebBrowser.JAVASCRIPT_1_1);
    res.setJavaEnabled(true);
    res.setFrameSupport(true);
  }
 else   if (agent.indexOf("Mozilla/2.") >= 0) {
    res.setJavaScriptVersion(WebBrowser.JAVASCRIPT_1_0);
    res.setJavaEnabled(true);
    res.setFrameSupport(true);
  }
 else   if (agent.indexOf("Mozilla/5.") >= 0) {
    res.setJavaScriptVersion(WebBrowser.JAVASCRIPT_1_5);
    res.setJavaEnabled(true);
    res.setFrameSupport(true);
    res.setMarkupVersion(WebBrowser.MARKUP_HTML_4_0);
  }
 else {
    res.setJavaScriptVersion(WebBrowser.JAVASCRIPT_UNCHECKED);
    res.setJavaEnabled(false);
    res.setMarkupVersion(WebBrowser.MARKUP_UNKNOWN);
    res.setFrameSupport(false);
  }
  return res;
}

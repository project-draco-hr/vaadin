{
  String requestWidgetset=getApplicationOrSystemProperty(PARAMETER_WIDGETSET,null);
  String sharedWidgetset=getPortalProperty(PORTAL_PARAMETER_VAADIN_WIDGETSET,request.getPortalContext());
  String widgetset;
  if (requestWidgetset != null) {
    widgetset=requestWidgetset;
  }
 else   if (sharedWidgetset != null) {
    widgetset=sharedWidgetset;
  }
 else {
    widgetset=DEFAULT_WIDGETSET;
  }
  String widgetsetURL=getWidgetsetURL(widgetset,request);
  writer.write("document.write('<iframe tabIndex=\"-1\" id=\"__gwt_historyFrame\" " + "style=\"position:absolute;width:0;height:0;border:0;overflow:" + "hidden;\" src=\"javascript:false\"></iframe>');\n");
  writer.write("document.write(\"<script language='javascript' src='" + widgetsetURL + "'><\\/script>\");\n}\n");
}

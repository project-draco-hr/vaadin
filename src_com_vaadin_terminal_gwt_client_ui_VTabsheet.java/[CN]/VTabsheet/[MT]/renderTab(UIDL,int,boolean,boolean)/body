{
  Tab tab=tb.getTab(index);
  if (tab == null) {
    tab=tb.addTab();
  }
  tab.updateFromUIDL(tabUidl);
  tab.setEnabledOnServer((!disabledTabKeys.contains(tabKeys.get(index))));
  tab.setHiddenOnServer(hidden);
  if (scrolledOutOfView(index)) {
    hidden=true;
  }
  tab.setVisible(!hidden);
  tab.recalculateCaptionWidth();
  UIDL tabContentUIDL=null;
  Paintable tabContent=null;
  if (tabUidl.getChildCount() > 0) {
    tabContentUIDL=tabUidl.getChildUIDL(0);
    tabContent=client.getPaintable(tabContentUIDL);
  }
  if (tabContent != null) {
    int oldIndex=tp.getWidgetIndex((Widget)tabContent);
    if (oldIndex != -1 && oldIndex != index) {
      tp.insert((Widget)tabContent,index);
    }
  }
 else {
    if (index < tp.getWidgetCount()) {
      Widget oldWidget=tp.getWidget(index);
      if (!(oldWidget instanceof PlaceHolder)) {
        tp.insert(new PlaceHolder(),index);
      }
    }
  }
  if (selected) {
    renderContent(tabContentUIDL);
    tb.selectTab(index);
  }
 else {
    if (tabContentUIDL != null) {
      if (tp.getWidgetIndex((Widget)tabContent) < 0) {
        tp.insert((Widget)tabContent,index);
      }
      tabContent.updateFromUIDL(tabContentUIDL,client);
    }
 else     if (tp.getWidgetCount() <= index) {
      tp.add(new PlaceHolder());
    }
  }
}

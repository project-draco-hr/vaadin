{
  LinkElement tagToReplace=null;
  if (oldTheme != null) {
    NodeList<Element> linkTags=getHead().getElementsByTagName(LinkElement.TAG);
    for (int i=0; i < linkTags.getLength(); i++) {
      final LinkElement link=LinkElement.as(linkTags.getItem(i));
      if ("stylesheet".equals(link.getRel()) && "text/css".equals(link.getType()) && oldThemeUrl.equals(link.getHref())) {
        tagToReplace=link;
        break;
      }
    }
    if (tagToReplace == null) {
      getLogger().warning("Did not find the link tag for the old theme (" + oldThemeUrl + "), adding a new stylesheet for the new theme ("+ newThemeUrl+ ")");
    }
  }
  if (newTheme != null) {
    loadTheme(newTheme,newThemeUrl,tagToReplace);
  }
 else {
    if (tagToReplace != null) {
      tagToReplace.getParentElement().removeChild(tagToReplace);
    }
    activateTheme(null);
  }
}

{
  final VaadinSession session=vaadinSession;
  session.access(new Runnable(){
    @Override public void run(){
      ArrayList<UI> uis=new ArrayList<UI>(session.getUIs());
      for (      final UI ui : uis) {
        ui.access(new Runnable(){
          @Override public void run(){
            if (!ui.isClosing()) {
              ui.close();
            }
            session.removeUI(ui);
          }
        }
);
      }
      eventRouter.fireEvent(new SessionDestroyEvent(VaadinService.this,session));
    }
  }
);
}

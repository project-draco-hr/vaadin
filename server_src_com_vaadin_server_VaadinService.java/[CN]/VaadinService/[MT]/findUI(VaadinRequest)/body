{
  VaadinSession session=VaadinSession.getForSession(this,request.getWrappedSession());
  String uiIdString=request.getParameter(UIConstants.UI_ID_PARAMETER);
  int uiId=Integer.parseInt(uiIdString);
  session.lock();
  try {
    UI ui=session.getUIById(uiId);
    UI.setCurrent(ui);
    return ui;
  }
  finally {
    session.unlock();
  }
}

{
  String encodedTransportType=valueAndType.getString(0);
  if (!isInternalType(targetType)) {
    throw new JSONException("Type " + targetType + " is not a supported internal type.");
  }
  String transportType=getInternalTransportType(targetType);
  if (!transportTypesCompatible(encodedTransportType,transportType)) {
    throw new JSONException("Expected a value of type " + targetType + ", received "+ getType(encodedTransportType));
  }
  Object encodedJsonValue=valueAndType.get(1);
  if (JsonEncoder.VTYPE_NULL.equals(encodedTransportType)) {
    return null;
  }
  if (JsonEncoder.VTYPE_LIST.equals(transportType)) {
    return decodeList(targetType,restrictToInternalTypes,(JSONArray)encodedJsonValue,application);
  }
 else   if (JsonEncoder.VTYPE_SET.equals(transportType)) {
    return decodeSet(targetType,restrictToInternalTypes,(JSONArray)encodedJsonValue,application);
  }
 else   if (JsonEncoder.VTYPE_MAP_CONNECTOR.equals(transportType)) {
    return decodeConnectorToObjectMap(targetType,restrictToInternalTypes,(JSONObject)encodedJsonValue,application);
  }
 else   if (JsonEncoder.VTYPE_MAP.equals(transportType)) {
    return decodeStringToObjectMap(targetType,restrictToInternalTypes,(JSONObject)encodedJsonValue,application);
  }
  if (JsonEncoder.VTYPE_ARRAY.equals(transportType)) {
    return decodeObjectArray(targetType,(JSONArray)encodedJsonValue,application);
  }
 else   if (JsonEncoder.VTYPE_STRINGARRAY.equals(transportType)) {
    return decodeStringArray((JSONArray)encodedJsonValue);
  }
  String stringValue=String.valueOf(encodedJsonValue);
  if (JsonEncoder.VTYPE_CONNECTOR.equals(transportType)) {
    return application.getConnector(stringValue);
  }
  if (JsonEncoder.VTYPE_STRING.equals(transportType)) {
    return stringValue;
  }
 else   if (JsonEncoder.VTYPE_INTEGER.equals(transportType)) {
    return Integer.valueOf(stringValue);
  }
 else   if (JsonEncoder.VTYPE_LONG.equals(transportType)) {
    return Long.valueOf(stringValue);
  }
 else   if (JsonEncoder.VTYPE_FLOAT.equals(transportType)) {
    return Float.valueOf(stringValue);
  }
 else   if (JsonEncoder.VTYPE_DOUBLE.equals(transportType)) {
    return Double.valueOf(stringValue);
  }
 else   if (JsonEncoder.VTYPE_BOOLEAN.equals(transportType)) {
    return Boolean.valueOf(stringValue);
  }
  throw new JSONException("Unknown type " + transportType);
}

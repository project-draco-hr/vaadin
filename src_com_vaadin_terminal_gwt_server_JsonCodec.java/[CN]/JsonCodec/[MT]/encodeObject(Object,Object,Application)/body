{
  JSONObject jsonMap=new JSONObject();
  try {
    for (    PropertyDescriptor pd : Introspector.getBeanInfo(value.getClass()).getPropertyDescriptors()) {
      String fieldName=getTransportFieldName(pd);
      if (fieldName == null) {
        continue;
      }
      Method getterMethod=pd.getReadMethod();
      Type fieldType=getterMethod.getGenericReturnType();
      Object fieldValue=getterMethod.invoke(value,(Object[])null);
      boolean equals=false;
      Object referenceFieldValue=null;
      if (referenceValue != null) {
        referenceFieldValue=getterMethod.invoke(referenceValue,(Object[])null);
        equals=equals(fieldValue,referenceFieldValue);
      }
      if (!equals) {
        jsonMap.put(fieldName,encode(fieldValue,referenceFieldValue,fieldType,application));
      }
    }
  }
 catch (  Exception e) {
    throw new JSONException(e);
  }
  return jsonMap;
}

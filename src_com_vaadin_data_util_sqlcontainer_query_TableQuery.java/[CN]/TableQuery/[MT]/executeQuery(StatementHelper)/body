{
  Connection c=null;
  if (transactionOpen && activeConnection != null) {
    c=activeConnection;
  }
 else {
    throw new SQLException("No active transaction!");
  }
  PreparedStatement pstmt=c.prepareStatement(sh.getQueryString());
  sh.setParameterValuesToStatement(pstmt);
  getLogger().log(Level.FINE,"DB -> " + sh.getQueryString());
  return pstmt.executeQuery();
}

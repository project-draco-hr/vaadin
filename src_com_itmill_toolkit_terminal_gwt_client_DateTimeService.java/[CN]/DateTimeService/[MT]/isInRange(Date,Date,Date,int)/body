{
  Date s;
  Date e;
  if (rangeStart.after(rangeEnd)) {
    s=rangeEnd;
    e=rangeStart;
  }
 else {
    e=rangeEnd;
    s=rangeStart;
  }
  if (date.getYear() < s.getYear() || date.getYear() > e.getYear()) {
    return false;
  }
 else   if (resolution == RESOLUTION_YEAR) {
    return true;
  }
  if (date.getMonth() < s.getMonth() || date.getMonth() > e.getMonth()) {
    return false;
  }
 else   if (resolution == RESOLUTION_MONTH) {
    return true;
  }
  if (date.getDate() < s.getDate() || date.getDate() > e.getDate()) {
    return false;
  }
 else   if (resolution == RESOLUTION_DAY) {
    return true;
  }
  if (date.getHours() < s.getHours() || date.getHours() > e.getHours()) {
    return false;
  }
 else   if (resolution == RESOLUTION_HOUR) {
    return true;
  }
  if (date.getMinutes() < s.getMinutes() || date.getMinutes() > e.getMinutes()) {
    return false;
  }
 else   if (resolution == RESOLUTION_MIN) {
    return true;
  }
  if (date.getSeconds() < s.getSeconds() || date.getSeconds() > e.getSeconds()) {
    return false;
  }
 else   if (resolution == RESOLUTION_SEC) {
    return true;
  }
  if (date.getTime() < s.getTime() || date.getTime() > e.getTime()) {
    return false;
  }
 else {
    return true;
  }
}

{
  if (getRequestType(request) == RequestType.UIDL) {
    SystemMessages ci=getVaadinService().getSystemMessages();
    criticalNotification(request,response,ci.getInternalErrorCaption(),ci.getInternalErrorMessage(),null,ci.getInternalErrorURL());
    if (vaadinSession != null) {
      vaadinSession.getErrorHandler().terminalError(new RequestError(e));
    }
 else {
      throw new PortletException(e);
    }
  }
 else {
    throw new PortletException(e);
  }
}

{
  if (isTimeOnDifferentDays()) {
    long range=(getEndTime().getTime() - getEnd().getTime()) / DateConstants.MINUTEINMILLIS;
    if (getEnd().compareTo(targetDay) != 0) {
      return getRangeInMinutes() - range;
    }
    return range;
  }
 else {
    return getRangeInMinutes();
  }
}

def addSummary(m):
    ticketnum = int(m.group(1))
    context = m.group(2)
    if re.match(' *\\(', context):
        return ('#%d%s' % (ticketnum, context))
    (summary, milestone) = fetchSummary(ticketnum)
    if summary.startswith('"'):
        summary = summary.strip('"')
        summary = summary.replace('""', '"')
    context = re.sub('#([0-9]+)(.*)', addSummary, context)
    return ('#%s (<i>%s</i>) %s' % (ticketnum, summary, context))

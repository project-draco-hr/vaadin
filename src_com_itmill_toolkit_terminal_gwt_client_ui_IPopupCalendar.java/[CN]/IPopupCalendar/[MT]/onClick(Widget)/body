{
  if (sender == calendarToggle && !open) {
    calendar.updateCalendar();
    popup.show();
    popup.setWidth("");
    popup.setHeight("");
    final int w=calendar.getOffsetWidth();
    final int h=calendar.getOffsetHeight();
    int t=calendarToggle.getAbsoluteTop();
    int l=calendarToggle.getAbsoluteLeft();
    if (l + w > Window.getClientWidth() + Window.getScrollLeft()) {
      l=Window.getClientWidth() + Window.getScrollLeft() - w;
    }
    if (t + h > Window.getClientHeight() + Window.getScrollTop()) {
      t=Window.getClientHeight() + Window.getScrollTop() - h - calendarToggle.getOffsetHeight() - 30;
      l+=calendarToggle.getOffsetWidth();
    }
    popup.setPopupPosition(l,t + calendarToggle.getOffsetHeight() + 2);
    popup.setWidth(w + "px");
    popup.setHeight(h + "px");
    open=true;
  }
 else {
    open=false;
  }
}

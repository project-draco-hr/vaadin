{
  super.onStateChanged(stateChangeEvent);
  Set<String> changedProperties=stateChangeEvent.getChangedProperties();
  if (changedProperties.contains("color")) {
    refreshColor();
    if (getState().showDefaultCaption && (getState().caption == null || "".equals(getState().caption))) {
      setCaption(getState().color);
    }
  }
  if (changedProperties.contains("caption") || changedProperties.contains("htmlContentAllowed") || changedProperties.contains("showDefaultCaption")) {
    setCaption(getCaption());
  }
}

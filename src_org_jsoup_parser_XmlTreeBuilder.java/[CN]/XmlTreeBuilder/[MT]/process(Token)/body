{
switch (token.type) {
case StartTag:
    insert(token.asStartTag());
  break;
case EndTag:
popStackToClose(token.asEndTag());
break;
case Comment:
insert(token.asComment());
break;
case Character:
insert(token.asCharacter());
break;
case Doctype:
insert(token.asDoctype());
break;
case EOF:
break;
default :
Validate.fail("Unexpected token type: " + token.type);
}
return true;
}

{
  Object id=tree.getValue();
  if (event.getProperty() == tree) {
    if (id == null) {
      tf.removeListener(this);
      tf.setValue("");
      tf.setEnabled(false);
    }
 else {
      tf.setEnabled(true);
      Item item=tree.getItem(id);
      tf.setValue(item.getItemProperty(CAPTION_PROPERTY).getValue());
      tf.addListener(this);
    }
  }
 else {
    if (id != null) {
      Item item=tree.getItem(id);
      Property p=item.getItemProperty(CAPTION_PROPERTY);
      p.setValue(tf.getValue());
      tree.requestRepaint();
    }
  }
}

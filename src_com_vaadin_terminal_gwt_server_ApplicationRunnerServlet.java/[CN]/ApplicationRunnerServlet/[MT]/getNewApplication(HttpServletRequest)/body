{
  try {
    final Class<? extends Application> applicationClass=getApplicationClass();
    if (Root.class.isAssignableFrom(applicationClass)) {
      return new Application(){
        @Override protected String getRootClassName(        WrappedRequest request){
          return applicationClass.getCanonicalName();
        }
      }
;
    }
    final Application application=applicationClass.newInstance();
    return application;
  }
 catch (  final IllegalAccessException e) {
    throw new ServletException(e);
  }
catch (  final InstantiationException e) {
    throw new ServletException(e);
  }
catch (  final ClassNotFoundException e) {
    throw new ServletException(new InstantiationException("Failed to load application class: " + getApplicationRunnerApplicationClassName(request)));
  }
}

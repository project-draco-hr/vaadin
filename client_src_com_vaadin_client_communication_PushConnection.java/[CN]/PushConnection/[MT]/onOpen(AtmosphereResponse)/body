{
  VConsole.log("Push connection established using " + response.getTransport());
  for (  String message : messageQueue) {
    doPush(socket,message);
  }
  messageQueue.clear();
switch (state) {
case CONNECT_PENDING:
    state=State.CONNECTED;
  break;
case DISCONNECT_PENDING:
state=State.CONNECTED;
disconnect();
break;
case CONNECTED:
break;
default :
throw new IllegalStateException("Got onOpen event when conncetion state is " + state + ". This should never happen.");
}
}

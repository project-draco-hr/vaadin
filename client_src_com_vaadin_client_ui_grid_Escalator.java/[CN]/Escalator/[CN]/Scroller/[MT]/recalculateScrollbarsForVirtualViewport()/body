{
  int scrollContentHeight=ROW_HEIGHT_PX * body.getRowCount();
  int scrollContentWidth=columnConfiguration.calculateRowWidth();
  double tableWrapperHeight=height;
  double tableWrapperWidth=width;
  boolean verticalScrollNeeded=scrollContentHeight > tableWrapperHeight - header.height - footer.height;
  boolean horizontalScrollNeeded=scrollContentWidth > tableWrapperWidth;
  if (verticalScrollNeeded != horizontalScrollNeeded) {
    if (!verticalScrollNeeded && horizontalScrollNeeded) {
      verticalScrollNeeded=scrollContentHeight > tableWrapperHeight - header.height - footer.height- horizontalScrollbar.getScrollbarThickness();
    }
 else {
      horizontalScrollNeeded=scrollContentWidth > tableWrapperWidth - verticalScrollbar.getScrollbarThickness();
    }
  }
  if (verticalScrollNeeded) {
    tableWrapperWidth-=verticalScrollbar.getScrollbarThickness();
  }
  if (horizontalScrollNeeded) {
    tableWrapperHeight-=horizontalScrollbar.getScrollbarThickness();
  }
  tableWrapper.getStyle().setHeight(tableWrapperHeight,Unit.PX);
  tableWrapper.getStyle().setWidth(tableWrapperWidth,Unit.PX);
  verticalScrollbar.setOffsetSize((int)(tableWrapperHeight - footer.height - header.height));
  verticalScrollbar.setScrollSize(scrollContentHeight);
  int prevScrollPos=horizontalScrollbar.getScrollPos();
  int unfrozenPixels=columnConfiguration.getCalculatedColumnsWidth(Range.between(columnConfiguration.getFrozenColumnCount(),columnConfiguration.getColumnCount()));
  int frozenPixels=scrollContentWidth - unfrozenPixels;
  double hScrollOffsetWidth=tableWrapperWidth - frozenPixels;
  horizontalScrollbar.setOffsetSize((int)hScrollOffsetWidth);
  horizontalScrollbar.setScrollSize(unfrozenPixels);
  horizontalScrollbar.getElement().getStyle().setLeft(frozenPixels,Unit.PX);
  horizontalScrollbar.setScrollPos(prevScrollPos);
}

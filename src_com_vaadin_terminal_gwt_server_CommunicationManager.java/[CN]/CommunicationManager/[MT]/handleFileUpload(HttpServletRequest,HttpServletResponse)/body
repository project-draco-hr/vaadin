{
  String pathInfo=request.getPathInfo();
  int startOfData=pathInfo.indexOf(AbstractApplicationServlet.UPLOAD_URL_PREFIX) + AbstractApplicationServlet.UPLOAD_URL_PREFIX.length();
  String uppUri=pathInfo.substring(startOfData);
  String[] parts=uppUri.split("/",3);
  StreamVariable streamVariable=pidToNameToStreamVariable.get(parts[0]).remove(parts[1]);
  String secKey=streamVariableToSeckey.remove(streamVariable);
  if (secKey.equals(parts[2])) {
    VariableOwner source=getVariableOwner(parts[0]);
    String contentType=request.getContentType();
    if (request.getContentType().contains("boundary")) {
      doHandleSimpleMultipartFileUpload(new HttpServletRequestWrapper(request),new HttpServletResponseWrapper(response),streamVariable,source,contentType.split("boundary=")[1]);
    }
 else {
      doHandleXhrFilePost(new HttpServletRequestWrapper(request),new HttpServletResponseWrapper(response),streamVariable,source,request.getContentLength());
    }
  }
 else {
    throw new InvalidUIDLSecurityKeyException("Security key in upload post did not match!");
  }
}

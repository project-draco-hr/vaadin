{
  if (!isPinned(itemId)) {
    throw new IllegalStateException("Item id " + itemId + " was not pinned");
  }
  pinnedItemIds.remove(itemId);
  final Integer removedIndex=indexToItemId.inverse().remove(itemId);
  if (removedIndex == null || !activeRange.contains(removedIndex.intValue())) {
    itemIdToKey.remove(itemId);
  }
}

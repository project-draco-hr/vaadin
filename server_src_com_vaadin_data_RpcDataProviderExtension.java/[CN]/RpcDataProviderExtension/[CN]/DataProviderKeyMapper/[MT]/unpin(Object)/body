{
  if (!isPinned(itemId)) {
    throw new IllegalStateException("Item id " + itemId + " was not pinned");
  }
  pinnedItemIds.remove(itemId);
  final Integer index=indexToItemId.inverse().get(itemId);
  if (index == null || !activeRange.contains(index.intValue())) {
    itemIdToKey.remove(itemId);
    indexToItemId.remove(index);
  }
}

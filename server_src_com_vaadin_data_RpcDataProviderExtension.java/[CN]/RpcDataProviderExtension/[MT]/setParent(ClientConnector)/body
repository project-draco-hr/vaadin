{
  super.setParent(parent);
  if (parent == null) {
    activeRowHandler.removeValueChangeListeners(activeRowHandler.activeRange);
    if (container instanceof ItemSetChangeNotifier) {
      ((ItemSetChangeNotifier)container).removeItemSetChangeListener(itemListener);
    }
  }
 else   if (parent instanceof Grid) {
    Grid grid=(Grid)parent;
    rowReference=new RowReference(grid);
    cellReference=new CellReference(rowReference);
  }
 else {
    throw new IllegalStateException("Grid is the only accepted parent type");
  }
}

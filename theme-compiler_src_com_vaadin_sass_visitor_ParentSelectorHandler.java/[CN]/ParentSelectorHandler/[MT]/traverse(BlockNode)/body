{
  Node parentNode=block.getParentNode();
  if (parentNode instanceof BlockNode) {
    boolean isParentSelector=false;
    ArrayList<String> newList=new ArrayList<String>(block.getSelectorList().size());
    BlockNode parentBlock=(BlockNode)parentNode;
    for (    final String s : block.getSelectorList()) {
      if (s.contains("&")) {
        for (        final String parentSelector : parentBlock.getSelectorList()) {
          newList.add(s.replace("&",parentSelector));
          isParentSelector=true;
        }
      }
    }
    if (isParentSelector) {
      block.setSelectorList(newList);
      Node oldparent=block.getParentNode();
      if (parentSelectors.containsKey(block.getParentNode())) {
        block.getParentNode().getParentNode().appendChild(block,parentSelectors.get(block.getParentNode()));
      }
 else {
        block.getParentNode().getParentNode().appendChild(block,block.getParentNode());
      }
      parentSelectors.put(oldparent,block);
    }
  }
}

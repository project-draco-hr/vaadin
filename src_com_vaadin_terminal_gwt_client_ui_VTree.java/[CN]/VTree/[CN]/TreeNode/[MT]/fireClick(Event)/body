{
  if (!treeHasFocus) {
    if (isIE6OrOpera()) {
      if (focusedNode == null) {
        getNodeByKey(key).setFocused(true);
      }
 else {
        focusedNode.setFocused(true);
      }
    }
 else {
      focus();
    }
  }
  final MouseEventDetails details=new MouseEventDetails(evt);
  ScheduledCommand command=new ScheduledCommand(){
    public void execute(){
      boolean sendClickEventNow=true;
      if (details.getButton() == NativeEvent.BUTTON_LEFT && immediate && selectable) {
        sendClickEventNow=false;
        if (isSelected() && selectedIds.size() == 1 && !isNullSelectionAllowed) {
          sendClickEventNow=true;
        }
      }
      client.updateVariable(paintableId,"clickedKey",key,false);
      client.updateVariable(paintableId,"clickEvent",details.toString(),sendClickEventNow);
    }
  }
;
  if (BrowserInfo.get().isWebkit() && !treeHasFocus) {
    Scheduler.get().scheduleDeferred(command);
  }
 else {
    command.execute();
  }
}

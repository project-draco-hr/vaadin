{
  VGridLayout layout=getWidget();
  layout.client=client;
  if (!isRealUpdate(uidl)) {
    return;
  }
  int cols=getState().getColumns();
  int rows=getState().getRows();
  layout.columnWidths=new int[cols];
  layout.rowHeights=new int[rows];
  if (layout.cells == null) {
    layout.cells=new Cell[cols][rows];
  }
 else   if (layout.cells.length != cols || layout.cells[0].length != rows) {
    Cell[][] newCells=new Cell[cols][rows];
    for (int i=0; i < layout.cells.length; i++) {
      for (int j=0; j < layout.cells[i].length; j++) {
        if (i < cols && j < rows) {
          newCells[i][j]=layout.cells[i][j];
        }
      }
    }
    layout.cells=newCells;
  }
  final int[] alignments=uidl.getIntArrayAttribute("alignments");
  int alignmentIndex=0;
  HashSet<Widget> nonRenderedWidgets=new HashSet<Widget>(layout.widgetToCell.keySet());
  for (final Iterator<?> i=uidl.getChildIterator(); i.hasNext(); ) {
    final UIDL r=(UIDL)i.next();
    if ("gr".equals(r.getTag())) {
      for (final Iterator<?> j=r.getChildIterator(); j.hasNext(); ) {
        final UIDL c=(UIDL)j.next();
        if ("gc".equals(c.getTag())) {
          Cell cell=layout.getCell(c);
          if (cell.hasContent()) {
            cell.setAlignment(new AlignmentInfo(alignments[alignmentIndex++]));
            nonRenderedWidgets.remove(cell.slot.getWidget());
          }
        }
      }
    }
  }
  layout.colExpandRatioArray=uidl.getIntArrayAttribute("colExpand");
  layout.rowExpandRatioArray=uidl.getIntArrayAttribute("rowExpand");
  for (  Widget w : nonRenderedWidgets) {
    Cell cell=layout.widgetToCell.remove(w);
    cell.slot.setCaption(null);
    if (w.getParent() == layout) {
      w.removeFromParent();
      ConnectorMap paintableMap=ConnectorMap.get(client);
      paintableMap.unregisterConnector(paintableMap.getConnector(w));
    }
    cell.slot.getWrapperElement().removeFromParent();
    cell.slot=null;
  }
  int bitMask=uidl.getIntAttribute("margins");
  layout.updateMarginStyleNames(new VMarginInfo(bitMask));
  layout.updateSpacingStyleName(getState().isSpacing());
  getLayoutManager().setNeedsUpdate(this);
}

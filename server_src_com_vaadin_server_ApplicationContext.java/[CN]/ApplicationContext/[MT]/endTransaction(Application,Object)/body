{
  LinkedList<Exception> exceptions=null;
  ArrayList<ApplicationContext.TransactionListener> currentListeners;
synchronized (listeners) {
    currentListeners=new ArrayList<ApplicationContext.TransactionListener>(listeners);
  }
  for (  ApplicationContext.TransactionListener listener : currentListeners) {
    try {
      listener.transactionEnd(application,request);
    }
 catch (    final RuntimeException t) {
      if (exceptions == null) {
        exceptions=new LinkedList<Exception>();
      }
      exceptions.add(t);
    }
  }
  if (exceptions != null) {
    final StringBuffer msg=new StringBuffer();
    for (    Exception e : exceptions) {
      if (msg.length() == 0) {
        msg.append("\n\n--------------------------\n\n");
      }
      msg.append(e.getMessage() + "\n");
      final StringWriter trace=new StringWriter();
      e.printStackTrace(new PrintWriter(trace,true));
      msg.append(trace.toString());
    }
    throw new RuntimeException(msg.toString());
  }
}

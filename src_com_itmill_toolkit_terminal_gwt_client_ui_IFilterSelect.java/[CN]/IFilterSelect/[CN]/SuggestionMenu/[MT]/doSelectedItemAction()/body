{
  final MenuItem item=getSelectedItem();
  if (allowNewItem) {
    final String newItemValue=tb.getText();
    int p=getItems().size();
    if (p > 0) {
      for (int i=0; i < p; i++) {
        final MenuItem potentialExactMatch=(MenuItem)getItems().get(i);
        if (potentialExactMatch.getText().equals(newItemValue)) {
          selectItem(potentialExactMatch);
          doItemAction(potentialExactMatch,true);
          suggestionPopup.hide();
          return;
        }
      }
    }
    if (!newItemValue.equals("")) {
      client.updateVariable(paintableId,"newitem",newItemValue,true);
    }
  }
 else   if (item != null && item.getText().toLowerCase().startsWith(lastFilter.toLowerCase())) {
    doItemAction(item,true);
  }
  suggestionPopup.hide();
}

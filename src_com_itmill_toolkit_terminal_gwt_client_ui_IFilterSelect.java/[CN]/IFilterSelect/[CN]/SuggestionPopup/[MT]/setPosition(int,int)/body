{
  int top=-1;
  int left=-1;
  menu.setHeight("");
  offsetHeight=getOffsetHeight();
  int desiredWidth=IFilterSelect.this.getOffsetWidth();
  int naturalMenuWidth=DOM.getElementPropertyInt(DOM.getFirstChild(menu.getElement()),"offsetWidth");
  if (naturalMenuWidth < desiredWidth) {
    menu.setWidth(desiredWidth + "px");
    DOM.setStyleAttribute(DOM.getFirstChild(menu.getElement()),"width","100%");
    naturalMenuWidth=desiredWidth;
  }
  if (Util.isIE()) {
    DOM.setStyleAttribute(getElement(),"width",naturalMenuWidth + "px");
  }
  if (offsetHeight + getPopupTop() > Window.getClientHeight() + Window.getScrollTop()) {
    top=Window.getClientHeight() + Window.getScrollTop() - offsetHeight - EXTRASPACE - IFilterSelect.this.getOffsetHeight();
    if (top < 0) {
      top=0;
    }
  }
 else {
    top=getPopupTop();
  }
  offsetWidth=DOM.getElementPropertyInt(DOM.getFirstChild(menu.getElement()),"offsetWidth");
  if (offsetWidth + getPopupLeft() > Window.getClientWidth() + Window.getScrollLeft()) {
    left=IFilterSelect.this.getAbsoluteLeft() + IFilterSelect.this.getOffsetWidth() + Window.getScrollLeft() - offsetWidth;
    if (left < 0) {
      left=0;
    }
  }
 else {
    left=getPopupLeft();
  }
  setPopupPosition(left,top);
}

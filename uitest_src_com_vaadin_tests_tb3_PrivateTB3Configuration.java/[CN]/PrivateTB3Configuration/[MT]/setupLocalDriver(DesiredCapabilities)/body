{
  WebDriver driver;
  if (BrowserUtil.isFirefox(desiredCapabilities)) {
    String firefoxPath=getProperty("firefox.path");
    if (firefoxPath != null) {
      driver=new FirefoxDriver(new FirefoxBinary(new File(firefoxPath)),null);
    }
 else {
      driver=new FirefoxDriver();
    }
  }
 else   if (BrowserUtil.isChrome(desiredCapabilities)) {
    String propertyName="chrome.driver.path";
    String chromeDriverPath=getProperty(propertyName);
    if (chromeDriverPath == null) {
      throw new RuntimeException("You need to install ChromeDriver to use @" + RunLocally.class.getSimpleName() + " with Chrome."+ "\nFirst install it from https://code.google.com/p/selenium/wiki/ChromeDriver."+ "\nThen update "+ propertiesFile.getAbsolutePath()+ " to define a property named "+ propertyName+ " containing the path of your local ChromeDriver installation.");
    }
    System.setProperty("webdriver.chrome.driver",chromeDriverPath);
    ChromeOptions options=new ChromeOptions();
    options.addArguments("--test-type ");
    driver=new ChromeDriver(options);
  }
 else   if (BrowserUtil.isSafari(desiredCapabilities)) {
    driver=new SafariDriver();
  }
 else   if (BrowserUtil.isPhantomJS(desiredCapabilities)) {
    driver=new PhantomJSDriver();
  }
 else {
    throw new RuntimeException("Not implemented support for running locally on " + BrowserUtil.getBrowserIdentifier(desiredCapabilities));
  }
  setDriver(TestBench.createDriver(driver));
  setDesiredCapabilities(desiredCapabilities);
}

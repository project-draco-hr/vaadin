{
  if (resource instanceof AtmosphereResourceImpl && !((AtmosphereResourceImpl)resource).isInScope()) {
    getLogger().fine("sendRefreshAndDisconnect called for resource no longer in scope");
    return;
  }
  AtmospherePushConnection connection=new AtmospherePushConnection(null);
  connection.connect(resource);
  try {
    connection.sendMessage(VaadinService.createCriticalNotificationJSON(null,null,null,null));
  }
  finally {
    connection.disconnect();
  }
}

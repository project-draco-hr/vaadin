{
  if (forceRedraw) {
    if (prevMonth == null) {
      prevYear=new VEventButton();
      prevYear.setHTML("&laquo;");
      prevYear.setStyleName("v-button-prevyear");
      nextYear=new VEventButton();
      nextYear.setHTML("&raquo;");
      nextYear.setStyleName("v-button-nextyear");
      prevYear.addMouseListener(this);
      nextYear.addMouseListener(this);
      setWidget(0,0,prevYear);
      setWidget(0,4,nextYear);
      if (needsMonth) {
        prevMonth=new VEventButton();
        prevMonth.setHTML("&lsaquo;");
        prevMonth.setStyleName("v-button-prevmonth");
        nextMonth=new VEventButton();
        nextMonth.setHTML("&rsaquo;");
        nextMonth.setStyleName("v-button-nextmonth");
        prevMonth.addMouseListener(this);
        nextMonth.addMouseListener(this);
        setWidget(0,3,nextMonth);
        setWidget(0,1,prevMonth);
      }
      getFlexCellFormatter().setColSpan(0,2,3);
      getRowFormatter().addStyleName(0,VDateField.CLASSNAME + "-calendarpanel-header");
    }
 else     if (!needsMonth) {
      prevMonth.removeMouseListener(this);
      nextMonth.removeMouseListener(this);
      remove(prevMonth);
      remove(nextMonth);
      prevMonth=null;
      nextMonth=null;
    }
    final int firstDay=datefield.getDateTimeService().getFirstDayOfWeek();
    for (int i=0; i < 7; i++) {
      int day=i + firstDay;
      if (day > 6) {
        day=0;
      }
      if (datefield.getCurrentResolution() > VDateField.RESOLUTION_MONTH) {
        setHTML(1,i,"<strong>" + datefield.getDateTimeService().getShortDay(day) + "</strong>");
      }
 else {
        setHTML(1,i,"");
      }
    }
  }
  final String monthName=needsMonth ? datefield.getDateTimeService().getMonth(datefield.getShowingDate().getMonth()) : "";
  final int year=datefield.getShowingDate().getYear() + 1900;
  setHTML(0,2,"<span class=\"" + VDateField.CLASSNAME + "-calendarpanel-month\">"+ monthName+ " "+ year+ "</span>");
}

{
  List<ComponentConnector> previousChildren=event.getOldChildren();
  int currentIndex=0;
  VAbstractOrderedLayout layout=getWidget();
  layout.setSpacing(getState().spacing);
  for (  ComponentConnector child : getChildComponents()) {
    Slot slot=layout.getSlot(child.getWidget());
    if (slot.getParent() != layout) {
      child.addStateChangeHandler(childStateChangeHandler);
    }
    layout.addOrMoveSlot(slot,currentIndex++);
  }
  for (  ComponentConnector child : previousChildren) {
    if (child.getParent() != this) {
      Slot slot=layout.getSlot(child.getWidget());
      slot.setWidgetResizeListener(null);
      if (slot.hasCaption()) {
        slot.setCaptionResizeListener(null);
      }
      if (slot.getSpacingElement() != null) {
        slot.setSpacingResizeListener(null);
      }
      child.removeStateChangeHandler(childStateChangeHandler);
      layout.removeWidget(child.getWidget());
    }
  }
  updateInternalState();
}

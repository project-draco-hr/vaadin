{
  if (event.getType().equals(BrowserEvents.CLICK)) {
    setActiveCell(cell);
    getElement().focus();
  }
 else   if (event.getType().equals(BrowserEvents.KEYDOWN)) {
    int newRow=activeRow;
    RowContainer newContainer=container;
    int newColumn=activeCellRange.getStart();
switch (event.getKeyCode()) {
case KeyCodes.KEY_DOWN:
      ++newRow;
    break;
case KeyCodes.KEY_UP:
  --newRow;
break;
case KeyCodes.KEY_RIGHT:
if (activeCellRange.getEnd() >= getVisibleColumns().size()) {
return;
}
++newColumn;
break;
case KeyCodes.KEY_LEFT:
if (newColumn == 0) {
return;
}
--newColumn;
break;
case KeyCodes.KEY_TAB:
if (event.getShiftKey()) {
newContainer=getPreviousContainer(container);
}
 else {
newContainer=getNextContainer(container);
}
if (newContainer == container) {
return;
}
break;
default :
return;
}
if (newContainer != container) {
if (newContainer == escalator.getBody()) {
newRow=lastActiveBodyRow;
}
 else if (newContainer == escalator.getHeader()) {
newRow=lastActiveHeaderRow;
}
 else {
newRow=lastActiveFooterRow;
}
}
 else if (newRow < 0) {
newContainer=getPreviousContainer(newContainer);
if (newContainer == container) {
newRow=0;
}
 else if (newContainer == escalator.getBody()) {
newRow=getLastVisibleRowIndex();
}
 else {
newRow=newContainer.getRowCount() - 1;
}
}
 else if (newRow >= container.getRowCount()) {
newContainer=getNextContainer(newContainer);
if (newContainer == container) {
newRow=container.getRowCount() - 1;
}
 else if (newContainer == escalator.getBody()) {
newRow=getFirstVisibleRowIndex();
}
 else {
newRow=0;
}
}
if (newContainer.getRowCount() == 0) {
return;
}
event.preventDefault();
event.stopPropagation();
setActiveCell(newRow,newColumn,newContainer);
}
}

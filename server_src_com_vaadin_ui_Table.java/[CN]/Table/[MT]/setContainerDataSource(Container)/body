{
  disableContentRefreshing();
  if (newDataSource == null) {
    newDataSource=new IndexedContainer();
  }
  if (newDataSource instanceof Container.Ordered) {
    super.setContainerDataSource(newDataSource);
  }
 else {
    super.setContainerDataSource(new ContainerOrderedWrapper(newDataSource));
  }
  currentPageFirstItemId=null;
  currentPageFirstItemIndex=0;
  if (collapsedColumns != null) {
    collapsedColumns.clear();
  }
  Collection<Object> col=new LinkedList<Object>();
  for (Iterator<?> it=getContainerPropertyIds().iterator(); it.hasNext(); ) {
    Object id=it.next();
    if (columnGenerators == null || !columnGenerators.containsKey(id)) {
      col.add(id);
    }
  }
  if (columnGenerators != null && columnGenerators.size() > 0) {
    col.addAll(columnGenerators.keySet());
  }
  setVisibleColumns(col.toArray());
  resetPageBuffer();
  enableContentRefreshing(true);
}

{
  if (getWidget().selectPopupItemWhenResponseIsReceived == VFilterSelect.Select.LAST) {
    getWidget().suggestionPopup.menu.selectLastItem();
  }
 else {
    getWidget().suggestionPopup.menu.selectFirstItem();
  }
  MenuItem activeMenuItem=getWidget().suggestionPopup.menu.getSelectedItem();
  getWidget().suggestionPopup.menu.setKeyboardSelectedItem(activeMenuItem);
  getWidget().setTextboxText(activeMenuItem.getText());
  getWidget().tb.setSelectionRange(getWidget().lastFilter.length(),activeMenuItem.getText().length() - getWidget().lastFilter.length());
  getWidget().selectPopupItemWhenResponseIsReceived=VFilterSelect.Select.NONE;
}

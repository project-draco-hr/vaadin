{
  Object owner=variables.get("dhowner");
  if (!(owner instanceof DropTarget)) {
    getLogger().severe("DropHandler owner " + owner + " must implement DropTarget");
    return;
  }
  DropTarget dropTarget=(DropTarget)owner;
  lastVisitId=(Integer)variables.get("visitId");
  boolean dropRequest=isDropRequest(variables);
  if (dropRequest) {
    handleDropRequest(dropTarget,variables);
  }
 else {
    handleDragRequest(dropTarget,variables);
  }
}

{
  Node originalParent=node.getParentNode();
  node.traverse();
  Map<String,VariableNode> variableScope=openVariableScope();
  for (int i=0; i < node.getChildren().size(); i++) {
    Node current=node.getChildren().get(i);
    if (traverse(current)) {
      --i;
    }
  }
  closeVariableScope(variableScope);
  lastNodeAdded.remove(originalParent);
  if (originalParent != null) {
    boolean removed=!originalParent.getChildren().contains(node);
    return removed;
  }
 else {
    return false;
  }
}

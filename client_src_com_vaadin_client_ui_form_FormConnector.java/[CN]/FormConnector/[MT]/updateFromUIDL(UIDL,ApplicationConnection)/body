{
  getWidget().client=client;
  getWidget().id=uidl.getId();
  if (!isRealUpdate(uidl)) {
    return;
  }
  boolean legendEmpty=true;
  if (getState().caption != null) {
    getWidget().caption.setInnerText(getState().caption);
    legendEmpty=false;
  }
 else {
    getWidget().caption.setInnerText("");
  }
  if (getIcon() != null) {
    if (getWidget().icon == null) {
      getWidget().icon=new Icon(client);
      getWidget().legend.insertFirst(getWidget().icon.getElement());
    }
    getWidget().icon.setUri(getIcon());
    legendEmpty=false;
  }
 else {
    if (getWidget().icon != null) {
      getWidget().legend.removeChild(getWidget().icon.getElement());
    }
  }
  if (legendEmpty) {
    getWidget().addStyleDependentName("nocaption");
  }
 else {
    getWidget().removeStyleDependentName("nocaption");
  }
  if (null != getState().errorMessage) {
    getWidget().errorMessage.updateMessage(getState().errorMessage);
    if (!getWidget().errorMessage.isVisible()) {
      getLayoutManager().addElementResizeListener(getWidget().errorMessage.getElement(),footerResizeListener);
    }
    getWidget().errorMessage.setVisible(true);
  }
 else {
    if (getWidget().errorMessage.isVisible()) {
      getLayoutManager().removeElementResizeListener(getWidget().errorMessage.getElement(),footerResizeListener);
    }
    getWidget().errorMessage.setVisible(false);
  }
  if (ComponentStateUtil.hasDescription(getState())) {
    getWidget().desc.setInnerHTML(getState().description);
    if (getWidget().desc.getParentElement() == null) {
      getWidget().fieldSet.insertAfter(getWidget().desc,getWidget().legend);
    }
  }
 else {
    getWidget().desc.setInnerHTML("");
    if (getWidget().desc.getParentElement() != null) {
      getWidget().fieldSet.removeChild(getWidget().desc);
    }
  }
  client.runDescendentsLayout(getWidget());
  if (uidl.getChildCount() >= 1) {
    UIDL childUidl=uidl.getChildByTagName("actions");
    if (childUidl != null) {
      if (getWidget().shortcutHandler == null) {
        getWidget().shortcutHandler=new ShortcutActionHandler(getConnectorId(),client);
        getWidget().keyDownRegistration=getWidget().addDomHandler(getWidget(),KeyDownEvent.getType());
      }
      getWidget().shortcutHandler.updateActionMap(childUidl);
    }
  }
 else   if (getWidget().shortcutHandler != null) {
    getWidget().keyDownRegistration.removeHandler();
    getWidget().shortcutHandler=null;
    getWidget().keyDownRegistration=null;
  }
}

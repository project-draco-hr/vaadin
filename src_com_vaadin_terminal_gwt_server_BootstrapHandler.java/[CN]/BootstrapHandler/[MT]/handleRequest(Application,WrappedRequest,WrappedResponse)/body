{
  if (request.getBrowserDetails() != null) {
    WebBrowser b=request.getBrowserDetails().getWebBrowser();
    if (b.isTooOldToFunctionProperly() && !b.isChromeFrameCapable()) {
      String c=request.getHeader("Cookie");
      if (c == null || !c.contains(FORCE_LOAD_COOKIE)) {
        writeBrowserTooOldPage(request,response);
        return true;
      }
    }
  }
  int rootId;
  try {
    Root root=application.getRootForRequest(request);
    if (root == null) {
      writeError(response,new Throwable("No Root found"));
      return true;
    }
    rootId=root.getRootId();
  }
 catch (  RootRequiresMoreInformationException e) {
    rootId=application.registerPendingRoot(request);
  }
  try {
    writeBootstrapPage(request,response,application,rootId);
  }
 catch (  JSONException e) {
    writeError(response,e);
  }
  return true;
}

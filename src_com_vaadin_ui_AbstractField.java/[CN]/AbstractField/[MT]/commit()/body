{
  if (dataSource != null && !dataSource.isReadOnly()) {
    if ((isInvalidCommitted() || isValid())) {
      final T newValue=getValue();
      try {
        valueWasModifiedByDataSourceDuringCommit=false;
        committingValueToDataSource=true;
        ((Property)dataSource).setValue(newValue);
      }
 catch (      final Throwable e) {
        currentBufferedSourceException=new Buffered.SourceException(this,e);
        requestRepaint();
        throw currentBufferedSourceException;
      }
 finally {
        committingValueToDataSource=false;
      }
    }
 else {
      validate();
    }
  }
  boolean repaintNeeded=false;
  if (modified) {
    modified=false;
    repaintNeeded=true;
  }
  if (currentBufferedSourceException != null) {
    currentBufferedSourceException=null;
    repaintNeeded=true;
  }
  if (valueWasModifiedByDataSourceDuringCommit) {
    valueWasModifiedByDataSourceDuringCommit=false;
    fireValueChange(false);
  }
 else   if (repaintNeeded) {
    requestRepaint();
  }
}

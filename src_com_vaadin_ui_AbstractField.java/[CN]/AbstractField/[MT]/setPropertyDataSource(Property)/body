{
  final Object oldValue=value;
  try {
    discard();
  }
 catch (  final Buffered.SourceException ignored) {
  }
  if (dataSource != null && Property.ValueChangeNotifier.class.isAssignableFrom(dataSource.getClass())) {
    ((Property.ValueChangeNotifier)dataSource).removeListener(this);
  }
  if (dataSource != null && Property.ReadOnlyStatusChangeNotifier.class.isAssignableFrom(dataSource.getClass())) {
    ((Property.ReadOnlyStatusChangeNotifier)dataSource).removeListener(this);
  }
  dataSource=newDataSource;
  try {
    if (dataSource != null) {
      setInternalValue(String.class == getType() ? dataSource.toString() : dataSource.getValue());
    }
    modified=false;
  }
 catch (  final Throwable e) {
    currentBufferedSourceException=new Buffered.SourceException(this,e);
    modified=true;
  }
  if (dataSource instanceof Property.ValueChangeNotifier) {
    ((Property.ValueChangeNotifier)dataSource).addListener(this);
  }
  if (dataSource instanceof Property.ReadOnlyStatusChangeNotifier) {
    ((Property.ReadOnlyStatusChangeNotifier)dataSource).addListener(this);
  }
  if (dataSource instanceof Validatable) {
    final Collection<Validator> validators=((Validatable)dataSource).getValidators();
    if (validators != null) {
      for (final Iterator<Validator> i=validators.iterator(); i.hasNext(); ) {
        addValidator(i.next());
      }
    }
  }
  if ((value != oldValue) && ((value != null && !value.equals(oldValue)) || value == null)) {
    fireValueChange(false);
  }
}

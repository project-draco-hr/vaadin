{
  if (!isAttached()) {
    return;
  }
  String zIndex=null;
  try {
    zIndex=DOM.getStyleAttribute(getElement(),"zIndex");
  }
 catch (  Exception ignore) {
    zIndex="1000";
  }
  if (zIndex == null) {
    zIndex="" + Z_INDEX;
  }
  if (BrowserInfo.get().isIE()) {
    getOffsetHeight();
    getOffsetWidth();
  }
  PositionAndSize positionAndSize=new PositionAndSize(getActualLeft(),getActualTop(),getOffsetWidth(),getOffsetHeight());
  positionAndSize.setAnimationFromCenterProgress(progress);
  if (BrowserInfo.get().isOpera() && isShadowEnabled()) {
    DOM.getChild(shadow,3).getStyle().setProperty("height","auto");
    DOM.getChild(shadow,4).getStyle().setProperty("height","auto");
    DOM.getChild(shadow,5).getStyle().setProperty("height","auto");
  }
  if (isShadowEnabled()) {
    updatePositionAndSize(shadow,positionAndSize);
    DOM.setStyleAttribute(shadow,"zIndex",zIndex);
    DOM.setStyleAttribute(shadow,"display",progress < 0.9 ? "none" : "");
  }
  if (needsShimElement()) {
    updatePositionAndSize((Element)Element.as(getShimElement()),positionAndSize);
  }
  if (BrowserInfo.get().isOpera() && isShadowEnabled()) {
    DOM.getChild(shadow,3).getStyle().setPropertyPx("height",DOM.getChild(shadow,3).getOffsetHeight());
    DOM.getChild(shadow,4).getStyle().setPropertyPx("height",DOM.getChild(shadow,4).getOffsetHeight());
    DOM.getChild(shadow,5).getStyle().setPropertyPx("height",DOM.getChild(shadow,5).getOffsetHeight());
  }
  if (isShadowEnabled() && !isShadowAttached()) {
    RootPanel.get().getElement().insertBefore(shadow,getElement());
    sinkShadowEvents();
  }
  if (needsShimElement() && !isShimElementAttached()) {
    RootPanel.get().getElement().insertBefore(getShimElement(),getElement());
  }
}

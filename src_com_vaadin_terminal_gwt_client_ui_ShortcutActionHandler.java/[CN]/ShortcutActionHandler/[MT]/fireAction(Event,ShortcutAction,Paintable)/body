{
  final Element et=DOM.eventGetTarget(event);
  if (target == null) {
    Widget w=Util.findWidget(et,null);
    while (w != null && !(w instanceof Paintable)) {
      w=w.getParent();
    }
    target=(Paintable)w;
  }
  final Paintable finalTarget=target;
  event.preventDefault();
  if (finalTarget instanceof BeforeShortcutActionListener) {
    ((BeforeShortcutActionListener)finalTarget).onBeforeShortcutAction(event);
  }
 else {
    shakeTarget(et);
    DeferredCommand.addCommand(new Command(){
      public void execute(){
        shakeTarget(et);
      }
    }
);
  }
  DeferredCommand.addCommand(new Command(){
    public void execute(){
      if (finalTarget != null) {
        client.updateVariable(paintableId,"actiontarget",finalTarget,false);
      }
      client.updateVariable(paintableId,"action",a.getKey(),true);
    }
  }
);
}

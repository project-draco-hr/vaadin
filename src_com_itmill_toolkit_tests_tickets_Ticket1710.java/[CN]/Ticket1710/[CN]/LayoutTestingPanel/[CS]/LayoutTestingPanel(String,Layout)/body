{
  super(caption);
  setLayout(internalLayout);
  testedLayout=layout;
  internalLayout.addComponent(controls);
  internalLayout.addComponent(testedLayout);
  internalLayout.setMargin(true);
  internalLayout.setSpacing(true);
  internalLayout.setComponentAlignment(testedLayout,OrderedLayout.ALIGNMENT_HORIZONTAL_CENTER,OrderedLayout.ALIGNMENT_VERTICAL_CENTER);
  controls.setWidth(100,OrderedLayout.UNITS_PERCENTAGE);
  controls.setStyleName("controls");
  controls.setSpacing(true);
  controls.setMargin(true);
  controls.addComponent(new Label("width"));
  controls.addComponent(new TextField(new MethodProperty(testedLayout,"width")));
  controls.addComponent(new Button("%",new MethodProperty(this,"widthPercents")));
  controls.addComponent(new Label("height"));
  controls.addComponent(new TextField(new MethodProperty(testedLayout,"height")));
  controls.addComponent(new Button("%",new MethodProperty(this,"heightPercents")));
  controls.addComponent(marginLeft);
  controls.addComponent(marginRight);
  controls.addComponent(marginTop);
  controls.addComponent(marginBottom);
  if (testedLayout instanceof Layout.SpacingHandler) {
    controls.addComponent(spacing);
  }
  Property.ValueChangeListener marginSpacingListener=new Property.ValueChangeListener(){
    public void valueChange(    ValueChangeEvent event){
      updateMarginsAndSpacing();
    }
  }
;
  marginBottom.addListener(marginSpacingListener);
  marginTop.addListener(marginSpacingListener);
  marginLeft.addListener(marginSpacingListener);
  marginRight.addListener(marginSpacingListener);
  spacing.addListener(marginSpacingListener);
  updateMarginsAndSpacing();
  addAlignmentControls();
  testedLayout.setStyleName("tested-layout");
  setStyleName("layout-testing-panel");
  for (Iterator i=controls.getComponentIterator(); i.hasNext(); ) {
    ((AbstractComponent)i.next()).setImmediate(true);
  }
}

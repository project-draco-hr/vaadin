{
  super.onStateChanged(stateChangeEvent);
  getWidget().disableOnClick=getState().disableOnClick;
  focusHandlerRegistration=EventHelper.updateFocusHandler(this,focusHandlerRegistration);
  blurHandlerRegistration=EventHelper.updateBlurHandler(this,blurHandlerRegistration);
  if (getState().htmlContentAllowed) {
    getWidget().setHTML(getState().caption);
  }
 else {
    getWidget().setText(getState().caption);
  }
  if (null != getState().errorMessage) {
    if (getWidget().errorIndicatorElement == null) {
      getWidget().errorIndicatorElement=DOM.createSpan();
      getWidget().errorIndicatorElement.setClassName("v-errorindicator");
    }
    getWidget().getElement().insertBefore(getWidget().errorIndicatorElement,getWidget().captionElement);
  }
 else   if (getWidget().errorIndicatorElement != null) {
    getWidget().getElement().removeChild(getWidget().errorIndicatorElement);
    getWidget().errorIndicatorElement=null;
  }
  if (getIcon() != null) {
    if (getWidget().icon == null) {
      getWidget().icon=new Icon(getConnection());
      getWidget().getElement().insertBefore(getWidget().icon.getElement(),getWidget().captionElement);
    }
    getWidget().icon.setUri(getIcon());
  }
 else {
    if (getWidget().icon != null) {
      getWidget().getElement().removeChild(getWidget().icon.getElement());
      getWidget().icon=null;
    }
  }
}

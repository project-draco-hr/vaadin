{
  if ("jar".equals(resourceUrl.getProtocol())) {
    if (!resourceUrl.getPath().contains("!/VAADIN/")) {
      getLogger().info("Blocked attempt to access a JAR entry not starting with /VAADIN/: " + resourceUrl);
      return false;
    }
    getLogger().fine("Accepted access to a JAR entry using a class loader: " + resourceUrl);
    return true;
  }
 else {
    if (!resourceUrl.getPath().contains("/VAADIN/") || resourceUrl.getPath().contains("/../")) {
      getLogger().info("Blocked attempt to access file: " + resourceUrl);
      return false;
    }
    getLogger().fine("Accepted access to a file using a class loader: " + resourceUrl);
    return true;
  }
}

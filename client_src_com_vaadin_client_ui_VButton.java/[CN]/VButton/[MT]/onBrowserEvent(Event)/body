{
  if (DOM.eventGetType(event) == Event.ONLOAD) {
    Util.notifyParentOfSizeChange(this,true);
  }
  if (!isEnabled()) {
    return;
  }
  int type=DOM.eventGetType(event);
switch (type) {
case Event.ONCLICK:
    if (disallowNextClick) {
      event.stopPropagation();
      disallowNextClick=false;
      return;
    }
  break;
case Event.ONMOUSEDOWN:
if (DOM.isOrHasChild(getElement(),DOM.eventGetTarget(event))) {
  setHovering(true);
}
if (event.getButton() == Event.BUTTON_LEFT) {
mousedownX=event.getClientX();
mousedownY=event.getClientY();
disallowNextClick=true;
clickPending=true;
setFocus(true);
DOM.setCapture(getElement());
isCapturing=true;
event.preventDefault();
if (BrowserInfo.get().isIE() || BrowserInfo.get().isOpera()) {
  addStyleName(CLASSNAME_PRESSED);
}
}
break;
case Event.ONMOUSEUP:
if (isCapturing) {
isCapturing=false;
DOM.releaseCapture(getElement());
if (isHovering() && event.getButton() == Event.BUTTON_LEFT) {
disallowNextClick=false;
}
if (BrowserInfo.get().isIE() || BrowserInfo.get().isOpera()) {
removeStyleName(CLASSNAME_PRESSED);
}
if (BrowserInfo.get().isIE8()) {
event.stopPropagation();
}
}
break;
case Event.ONMOUSEMOVE:
clickPending=false;
if (isCapturing) {
DOM.eventPreventDefault(event);
}
break;
case Event.ONMOUSEOUT:
Element to=event.getRelatedTarget();
if (getElement().isOrHasChild(DOM.eventGetTarget(event)) && (to == null || !getElement().isOrHasChild(to))) {
if (clickPending && Math.abs(mousedownX - event.getClientX()) < MOVE_THRESHOLD && Math.abs(mousedownY - event.getClientY()) < MOVE_THRESHOLD) {
onClick();
break;
}
clickPending=false;
if (isCapturing) {
}
setHovering(false);
if (BrowserInfo.get().isIE() || BrowserInfo.get().isOpera()) {
removeStyleName(CLASSNAME_PRESSED);
}
}
break;
case Event.ONBLUR:
if (isFocusing) {
isFocusing=false;
}
break;
case Event.ONLOSECAPTURE:
if (isCapturing) {
isCapturing=false;
}
break;
}
super.onBrowserEvent(event);
if ((event.getTypeInt() & Event.KEYEVENTS) != 0) {
switch (type) {
case Event.ONKEYDOWN:
if (event.getKeyCode() == 32) {
isFocusing=true;
event.preventDefault();
event.stopPropagation();
}
 else if (event.getKeyCode() == KeyCodes.KEY_ENTER) {
event.stopPropagation();
}
break;
case Event.ONKEYUP:
if (isFocusing && event.getKeyCode() == 32) {
isFocusing=false;
onClick();
event.stopPropagation();
event.preventDefault();
}
break;
case Event.ONKEYPRESS:
if (event.getKeyCode() == KeyCodes.KEY_ENTER) {
onClick();
event.stopPropagation();
event.preventDefault();
}
break;
}
}
}

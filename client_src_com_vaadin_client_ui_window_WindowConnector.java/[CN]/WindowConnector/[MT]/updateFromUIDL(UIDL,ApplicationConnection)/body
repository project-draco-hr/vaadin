{
  getWidget().id=getConnectorId();
  getWidget().client=client;
  DOM.setElementProperty(getWidget().closeBox,"id",getConnectorId() + "_window_close");
  if (isRealUpdate(uidl)) {
    if (getState().modal != getWidget().vaadinModality) {
      getWidget().setVaadinModality(!getWidget().vaadinModality);
    }
    if (!getWidget().isAttached()) {
      getWidget().setVisible(false);
      getWidget().show();
    }
    if (getState().resizable != getWidget().resizable) {
      getWidget().setResizable(getState().resizable);
    }
    getWidget().resizeLazy=getState().resizeLazy;
    getWidget().setDraggable(getState().draggable);
    String iconURL=null;
    if (getIcon() != null) {
      iconURL=getIcon();
    }
    getWidget().setCaption(getState().caption,iconURL);
  }
  getWidget().visibilityChangesDisabled=true;
  if (!isRealUpdate(uidl)) {
    return;
  }
  getWidget().visibilityChangesDisabled=false;
  clickEventHandler.handleEventHandlerRegistration();
  getWidget().immediate=getState().immediate;
  getWidget().setClosable(!isReadOnly());
  int positionx=getState().positionX;
  int positiony=getState().positionY;
  if (positionx >= 0 || positiony >= 0) {
    if (positionx < 0) {
      positionx=0;
    }
    if (positiony < 0) {
      positiony=0;
    }
    getWidget().setPopupPosition(positionx,positiony);
  }
  int childIndex=0;
  for (int i=0; i < uidl.getChildCount(); i++) {
    UIDL childUidl=uidl.getChildUIDL(i);
    if (childUidl.getTag().equals("actions")) {
      if (getWidget().shortcutHandler == null) {
        getWidget().shortcutHandler=new ShortcutActionHandler(getConnectorId(),client);
      }
      getWidget().shortcutHandler.updateActionMap(childUidl);
    }
  }
  getWidget().contentPanel.setScrollPosition(getState().scrollTop);
  getWidget().contentPanel.setHorizontalScrollPosition(getState().scrollLeft);
  getWidget().centered=getState().centered;
  getWidget().setVisible(true);
  if (getWidget().getOffsetWidth() > Window.getClientWidth()) {
    getWidget().setWidth(Window.getClientWidth() + "px");
  }
  if (getWidget().getOffsetHeight() > Window.getClientHeight()) {
    getWidget().setHeight(Window.getClientHeight() + "px");
  }
  if (uidl.hasAttribute("bringToFront")) {
    getWidget().contentPanel.focus();
    getWidget().bringToFrontSequence=uidl.getIntAttribute("bringToFront");
    VWindow.deferOrdering();
  }
}

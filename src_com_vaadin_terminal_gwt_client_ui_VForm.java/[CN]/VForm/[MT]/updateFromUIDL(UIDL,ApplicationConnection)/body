{
  rendering=true;
  this.client=client;
  id=uidl.getId();
  if (client.updateComponent(this,uidl,false)) {
    rendering=false;
    return;
  }
  boolean legendEmpty=true;
  if (uidl.hasAttribute("caption")) {
    DOM.setInnerText(caption,uidl.getStringAttribute("caption"));
    legendEmpty=false;
  }
 else {
    DOM.setInnerText(caption,"");
  }
  if (uidl.hasAttribute("icon")) {
    if (icon == null) {
      icon=new Icon(client);
      DOM.insertChild(legend,icon.getElement(),0);
    }
    icon.setUri(uidl.getStringAttribute("icon"));
    legendEmpty=false;
  }
 else {
    if (icon != null) {
      DOM.removeChild(legend,icon.getElement());
    }
  }
  if (legendEmpty) {
    addStyleDependentName("nocaption");
  }
 else {
    removeStyleDependentName("nocaption");
  }
  if (uidl.hasAttribute("error")) {
    final UIDL errorUidl=uidl.getErrors();
    errorMessage.updateFromUIDL(errorUidl);
    errorMessage.setVisible(true);
  }
 else {
    errorMessage.setVisible(false);
  }
  if (uidl.hasAttribute("description")) {
    DOM.setInnerHTML(desc,uidl.getStringAttribute("description"));
  }
 else {
    DOM.setInnerHTML(desc,"");
  }
  updateSize();
  client.runDescendentsLayout(this);
  if (uidl.getChildCount() > 1 && !uidl.getChildUIDL(1).getTag().equals("actions")) {
    Container newFooter=(Container)client.getPaintable(uidl.getChildUIDL(1));
    if (footer == null) {
      add((Widget)newFooter,footerContainer);
      footer=newFooter;
    }
 else     if (newFooter != footer) {
      remove((Widget)footer);
      client.unregisterPaintable(footer);
      add((Widget)newFooter,footerContainer);
    }
    footer=newFooter;
    footer.updateFromUIDL(uidl.getChildUIDL(1),client);
    updateSize();
  }
 else {
    if (footer != null) {
      remove((Widget)footer);
      client.unregisterPaintable(footer);
      updateSize();
    }
  }
  final UIDL layoutUidl=uidl.getChildUIDL(0);
  Container newLo=(Container)client.getPaintable(layoutUidl);
  if (lo == null) {
    lo=newLo;
    add((Widget)lo,fieldContainer);
  }
 else   if (lo != newLo) {
    client.unregisterPaintable(lo);
    remove((Widget)lo);
    lo=newLo;
    add((Widget)lo,fieldContainer);
  }
  lo.updateFromUIDL(layoutUidl,client);
  updateSize();
  client.runDescendentsLayout(this);
  if (uidl.getChildCount() > 1) {
    UIDL childUidl=uidl.getChildByTagName("actions");
    if (childUidl != null) {
      if (shortcutHandler == null) {
        shortcutHandler=new ShortcutActionHandler(id,client);
        keyDownRegistration=addDomHandler(this,KeyDownEvent.getType());
      }
      shortcutHandler.updateActionMap(childUidl);
    }
  }
 else   if (shortcutHandler != null) {
    keyDownRegistration.removeHandler();
    shortcutHandler=null;
    keyDownRegistration=null;
  }
  rendering=false;
}

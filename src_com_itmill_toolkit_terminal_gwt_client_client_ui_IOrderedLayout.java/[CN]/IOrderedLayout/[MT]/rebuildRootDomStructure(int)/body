{
  boolean newTableMode=!(orientationMode == ORIENTATION_VERTICAL && width != null);
  if (oldOrientationMode == orientationMode && newTableMode == tableMode) {
    return;
  }
  boolean oldTableMode=tableMode;
  tableMode=newTableMode;
  if (tableMode) {
    Element tmp=DOM.createDiv();
    final String structure="<table cellspacing=\"0\" cellpadding=\"0\"><tbody>" + (orientationMode == ORIENTATION_HORIZONTAL ? "<tr></tr>" : "") + "</tbody></table>";
    DOM.setInnerHTML(tmp,structure);
    root=DOM.getFirstChild(tmp);
    DOM.removeChild(tmp,root);
    wrappedChildContainer=DOM.getFirstChild(root);
    if (orientationMode == ORIENTATION_HORIZONTAL) {
      wrappedChildContainer=DOM.getFirstChild(wrappedChildContainer);
    }
  }
 else {
    wrappedChildContainer=root=DOM.createDiv();
  }
  if (width != null && !"".equals(width)) {
    DOM.setStyleAttribute(root,"width",width);
  }
  if (height != null && !"".equals(height)) {
    DOM.setStyleAttribute(root,"height",height);
  }
  String styles=getStyleName();
  setElement(root);
  setStyleName(styles);
  final int currentOrientationMode=orientationMode;
  for (int i=0; i < childWidgetWrappers.size(); i++) {
    WidgetWrapper wr=(WidgetWrapper)childWidgetWrappers.get(i);
    orientationMode=oldOrientationMode;
    tableMode=oldTableMode;
    Element oldWrElement=wr.getElementWrappingWidgetAndCaption();
    orientationMode=currentOrientationMode;
    tableMode=newTableMode;
    String classe=DOM.getElementAttribute(oldWrElement,"class");
    wr.resetRootElement();
    Element newWrElement=wr.getElementWrappingWidgetAndCaption();
    if (classe != null && classe.length() > 0) {
      DOM.setElementAttribute(newWrElement,"class",classe);
    }
    while (DOM.getChildCount(oldWrElement) > 0) {
      Element c=DOM.getFirstChild(oldWrElement);
      DOM.removeChild(oldWrElement,c);
      DOM.appendChild(newWrElement,c);
    }
    DOM.appendChild(wrappedChildContainer,wr.getElement());
  }
  childLayoutsHaveChanged=true;
}

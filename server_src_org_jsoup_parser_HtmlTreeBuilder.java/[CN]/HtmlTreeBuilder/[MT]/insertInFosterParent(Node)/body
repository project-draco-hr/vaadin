{
  Element fosterParent=null;
  Element lastTable=getFromStack("table");
  boolean isLastTableParent=false;
  if (lastTable != null) {
    if (lastTable.parent() != null) {
      fosterParent=lastTable.parent();
      isLastTableParent=true;
    }
 else     fosterParent=aboveOnStack(lastTable);
  }
 else {
    fosterParent=stack.get(0);
  }
  if (isLastTableParent) {
    Validate.notNull(lastTable);
    lastTable.before(in);
  }
 else   fosterParent.appendChild(in);
}

{
  debug("VFS: onBlur()");
  if (BrowserInfo.get().isIE() && preventNextBlurEventInIE) {
    preventNextBlurEventInIE=false;
    Element focusedElement=WidgetUtil.getFocusedElement();
    if (getElement().isOrHasChild(focusedElement) || suggestionPopup.getElement().isOrHasChild(focusedElement)) {
      iePreventNextFocus=true;
      tb.setFocus(true);
      return;
    }
  }
  focused=false;
  if (!readonly) {
    if (tabPressedWhenPopupOpen) {
      tabPressedWhenPopupOpen=false;
      waitingForFilteringResponse=false;
      suggestionPopup.menu.doSelectedItemAction();
      suggestionPopup.hide();
    }
 else     if ((!suggestionPopup.isAttached() && waitingForFilteringResponse) || suggestionPopup.isJustClosed()) {
      waitingForFilteringResponse=false;
      suggestionPopup.menu.doSelectedItemAction();
    }
    if (selectedOptionKey == null) {
      setPromptingOn();
    }
 else     if (currentSuggestion != null) {
      setPromptingOff(currentSuggestion.caption);
    }
  }
  removeStyleDependentName("focus");
  if (client.hasEventListeners(this,EventId.BLUR)) {
    client.updateVariable(paintableId,EventId.BLUR,"",true);
    afterUpdateClientVariables();
  }
}

{
  if (autoCommit) {
    try {
      delegate.beginTransaction();
      boolean success=true;
      for (      Object id : getItemIds()) {
        if (!delegate.removeRow((RowItem)getItem(id))) {
          success=false;
        }
      }
      if (success) {
        delegate.commit();
        getLogger().log(Level.FINER,"All rows removed from DB...");
        refresh();
        if (notificationsEnabled) {
          CacheFlushNotifier.notifyOfCacheFlush(this);
        }
      }
 else {
        delegate.rollback();
      }
      return success;
    }
 catch (    SQLException e) {
      getLogger().log(Level.WARNING,"removeAllItems() failed, rolling back",e);
      try {
        delegate.rollback();
      }
 catch (      SQLException ee) {
        getLogger().log(Level.SEVERE,"Failed to roll back",ee);
      }
      return false;
    }
catch (    OptimisticLockException e) {
      getLogger().log(Level.WARNING,"removeAllItems() failed, rolling back",e);
      try {
        delegate.rollback();
      }
 catch (      SQLException ee) {
        getLogger().log(Level.SEVERE,"Failed to roll back",ee);
      }
      throw e;
    }
  }
 else {
    for (    Object id : getItemIds()) {
      removedItems.put((RowId)id,(RowItem)getItem(id));
      cachedItems.remove(id);
    }
    refresh();
    return true;
  }
}

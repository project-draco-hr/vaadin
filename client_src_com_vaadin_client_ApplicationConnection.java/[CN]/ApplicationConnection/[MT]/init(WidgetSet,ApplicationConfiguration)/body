{
  VConsole.log("Starting application " + cnf.getRootPanelId());
  VConsole.log("Using theme: " + cnf.getThemeName());
  VConsole.log("Vaadin application servlet version: " + cnf.getServletVersion());
  if (!cnf.getServletVersion().equals(Version.getFullVersion())) {
    VConsole.error("Warning: your widget set seems to be built with a different " + "version than the one used on server. Unexpected " + "behavior may occur.");
  }
  this.widgetSet=widgetSet;
  configuration=cnf;
  ComponentLocator componentLocator=new ComponentLocator(this);
  String appRootPanelName=cnf.getRootPanelId();
  appRootPanelName=appRootPanelName.replaceFirst("-\\d+$","");
  initializeTestbenchHooks(componentLocator,appRootPanelName);
  initializeClientHooks();
  uIConnector.init(cnf.getRootPanelId(),this);
  tooltip.setOwner(uIConnector.getWidget());
  getLoadingIndicator().show();
  scheduleHeartbeat();
  Window.addWindowClosingHandler(new ClosingHandler(){
    @Override public void onWindowClosing(    ClosingEvent event){
      if (hasActiveRequest()) {
        retryCanceledActiveRequest=true;
      }
      webkitMaybeIgnoringRequests=true;
    }
  }
);
}

{
  JsonArray reqJson=Json.createArray();
  if (!pendingInvocations.isEmpty()) {
    if (ApplicationConfiguration.isDebugMode()) {
      Util.logVariableBurst(this,pendingInvocations.values());
    }
    for (    MethodInvocation invocation : pendingInvocations.values()) {
      JsonArray invocationJson=Json.createArray();
      invocationJson.set(0,invocation.getConnectorId());
      invocationJson.set(1,invocation.getInterfaceName());
      invocationJson.set(2,invocation.getMethodName());
      JsonArray paramJson=Json.createArray();
      Type[] parameterTypes=null;
      if (!isLegacyVariableChange(invocation) && !isJavascriptRpc(invocation)) {
        try {
          Type type=new Type(invocation.getInterfaceName(),null);
          Method method=type.getMethod(invocation.getMethodName());
          parameterTypes=method.getParameterTypes();
        }
 catch (        NoDataException e) {
          throw new RuntimeException("No type data for " + invocation.toString(),e);
        }
      }
      for (int i=0; i < invocation.getParameters().length; ++i) {
        Type type=null;
        if (parameterTypes != null) {
          type=parameterTypes[i];
        }
        Object value=invocation.getParameters()[i];
        JsonValue jsonValue=JsonEncoder.encode(value,type,this);
        paramJson.set(i,jsonValue);
      }
      invocationJson.set(3,paramJson);
      reqJson.set(reqJson.length(),invocationJson);
    }
    pendingInvocations.clear();
    lastInvocationTag=0;
  }
  String extraParams="";
  if (!getConfiguration().isWidgetsetVersionSent()) {
    if (!extraParams.isEmpty()) {
      extraParams+="&";
    }
    String widgetsetVersion=Version.getFullVersion();
    extraParams+="v-wsver=" + widgetsetVersion;
    getConfiguration().setWidgetsetVersionSent();
  }
  makeUidlRequest(reqJson,extraParams);
}

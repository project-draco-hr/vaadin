{
  Class<?> cls=implementation.getClass();
  Class<?>[] interfaces=cls.getInterfaces();
  while (interfaces.length == 0) {
    cls=cls.getSuperclass();
    interfaces=cls.getInterfaces();
  }
  if (interfaces.length != 1 || !(ServerRpc.class.isAssignableFrom(interfaces[0]))) {
    throw new RuntimeException("Use registerRpc(T implementation, Class<T> rpcInterfaceType) if the Rpc implementation implements more than one interface");
  }
  @SuppressWarnings("unchecked") Class<T> type=(Class<T>)interfaces[0];
  registerRpc(implementation,type);
}

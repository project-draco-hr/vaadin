{
  Stack<MenuItem> items=new Stack<MenuItem>();
  boolean found=false;
  if (variables.containsKey("clickedId")) {
    Integer clickedId=(Integer)variables.get("clickedId");
    Iterator<MenuItem> itr=getItems().iterator();
    while (itr.hasNext()) {
      items.push(itr.next());
    }
    MenuItem tmpItem=null;
    while (!found && !items.empty()) {
      tmpItem=items.pop();
      found=(clickedId.intValue() == tmpItem.getId());
      if (tmpItem.hasChildren()) {
        itr=tmpItem.getChildren().iterator();
        while (itr.hasNext()) {
          items.push(itr.next());
        }
      }
    }
    if (found && tmpItem.isEnabled()) {
      if (tmpItem.isSelectable()) {
        tmpItem.setSelected(!tmpItem.isSelected());
      }
      if (null != tmpItem.getCommand()) {
        tmpItem.getCommand().menuSelected(tmpItem);
      }
    }
  }
}

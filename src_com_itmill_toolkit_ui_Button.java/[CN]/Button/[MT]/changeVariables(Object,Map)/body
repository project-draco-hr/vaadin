{
  if (variables.containsKey("state")) {
    Boolean newValue=(Boolean)variables.get("state");
    Boolean oldValue=(Boolean)getValue();
    if (isSwitchMode()) {
      if (newValue != null && !newValue.equals(oldValue) && !isReadOnly()) {
        setValue(newValue);
        fireClick();
      }
    }
 else {
      if (newValue.booleanValue())       fireClick();
      if (oldValue.booleanValue())       setValue(new Boolean(false));
    }
  }
  if (variables.containsKey("action")) {
    StringTokenizer st=new StringTokenizer((String)variables.get("action"),",");
    if (st.countTokens() == 2) {
      Action action=(Action)actionMapper.get(st.nextToken());
      if (action != null && actionHandlers != null)       for (Iterator i=actionHandlers.iterator(); i.hasNext(); )       ((Action.Handler)i.next()).handleAction(action,this,this);
    }
  }
}

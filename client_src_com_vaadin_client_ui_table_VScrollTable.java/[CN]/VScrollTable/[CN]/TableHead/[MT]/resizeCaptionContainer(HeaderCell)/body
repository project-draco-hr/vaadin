{
  HeaderCell lastcell=getHeaderCell(visibleCells.size() - 1);
  int columnTotalWidth=0;
  for (  Widget w : visibleCells) {
    columnTotalWidth+=w.getOffsetWidth();
  }
  if (cell == lastcell && columnSelector.getOffsetWidth() > 0 && columnTotalWidth >= div.getOffsetWidth() - columnSelector.getOffsetWidth() && !hasVerticalScrollbar()) {
    int offset=0;
    int diff=div.getOffsetWidth() - columnTotalWidth;
    if (diff < columnSelector.getOffsetWidth() && diff > 0) {
      offset=columnSelector.getOffsetWidth() - diff;
    }
 else {
      offset=columnSelector.getOffsetWidth();
    }
    lastcell.resizeCaptionContainer(offset);
  }
 else {
    cell.resizeCaptionContainer(0);
  }
}

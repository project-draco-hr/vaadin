{
  if (getFilteredItemIds() != null) {
    if (!getFilteredItemIds().contains(itemId)) {
      return null;
    }
    final Iterator<?> i=getFilteredItemIds().iterator();
    if (itemId == null) {
      return null;
    }
    Object prev=null;
    Object current;
    while (i.hasNext() && !itemId.equals(current=i.next())) {
      prev=current;
    }
    return prev;
  }
  try {
    return allItemIds.get(allItemIds.indexOf(itemId) - 1);
  }
 catch (  final IndexOutOfBoundsException e) {
    return null;
  }
}

{
  if (!hasFilters) {
    setFilteredItemIds(null);
    if (filters != null) {
      filters=null;
      return true;
    }
    return false;
  }
  if (getFilteredItemIds() == null) {
    setFilteredItemIds(new LinkedHashSet<Object>());
  }
 else {
    getFilteredItemIds().clear();
  }
  for (final Iterator<?> i=allItemIds.iterator(); i.hasNext(); ) {
    final Object id=i.next();
    if (passesFilters(id)) {
      getFilteredItemIds().add(id);
    }
  }
  return true;
}

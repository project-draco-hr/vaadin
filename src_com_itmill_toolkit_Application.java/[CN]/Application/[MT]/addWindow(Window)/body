{
  if (window == null)   return;
  String name=window.getName();
  if (name != null && windows.containsKey(name)) {
    if (window == windows.get(name))     return;
    throw new IllegalArgumentException("Window with name '" + window.getName() + "' is already present in the application");
  }
  if (name == null) {
    boolean accepted=false;
    while (!accepted) {
      name=String.valueOf(Math.abs(nameGenerator.nextInt()));
      if (!windows.containsKey(name))       accepted=true;
    }
    window.setName(name);
  }
  windows.put(name,window);
  window.setApplication(this);
  fireWindowAttachEvent(window);
  if (getMainWindow() == null)   setMainWindow(window);
}

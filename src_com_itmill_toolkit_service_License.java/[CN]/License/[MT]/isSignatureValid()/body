{
  if (signatureIsValid)   return true;
  try {
    CertificateFactory x509factory=CertificateFactory.getInstance("X.509");
    X509Certificate cert=(X509Certificate)x509factory.generateCertificate(new ByteArrayInputStream(certificate.getBytes()));
    PublicKey publicKey=cert.getPublicKey();
    Signature dsa=Signature.getInstance("SHA1withDSA");
    dsa.initVerify(publicKey);
    dsa.update(getNormalizedLicenseData().getBytes("UTF-8"));
    if (dsa.verify(getSignature())) {
      signatureIsValid=true;
      return true;
    }
  }
 catch (  NoSuchAlgorithmException e) {
    throw new RuntimeException(e);
  }
catch (  InvalidKeyException e) {
    throw new RuntimeException(e);
  }
catch (  SignatureException e) {
    throw new LicenseSignatureIsInvalid();
  }
catch (  UnsupportedEncodingException e) {
    throw new RuntimeException(e);
  }
catch (  CertificateException e) {
    throw new RuntimeException(e);
  }
  return false;
}

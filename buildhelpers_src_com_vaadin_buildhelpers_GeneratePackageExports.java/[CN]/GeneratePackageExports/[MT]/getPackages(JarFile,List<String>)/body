{
  HashSet<String> packages=new HashSet<String>();
  for (Enumeration<JarEntry> it=jar.entries(); it.hasMoreElements(); ) {
    JarEntry entry=it.nextElement();
    if (!entry.getName().endsWith(".class")) {
      continue;
    }
    boolean accept=false;
    for (    String prefix : acceptedPackagePrefixes) {
      if (entry.getName().startsWith(prefix)) {
        accept=true;
        break;
      }
    }
    if (!accept) {
      continue;
    }
    int lastSlash=entry.getName().lastIndexOf('/');
    String pkg=entry.getName().substring(0,lastSlash).replace('/','.');
    packages.add(pkg);
  }
  for (Enumeration<JarEntry> it=jar.entries(); it.hasMoreElements(); ) {
    JarEntry entry=it.nextElement();
    if (entry.isDirectory() && entry.getName().startsWith("VAADIN/themes")) {
      int lastSlash=entry.getName().lastIndexOf('/');
      String pkg=entry.getName().substring(0,lastSlash).replace('/','.');
      packages.add(pkg);
    }
  }
  return packages;
}

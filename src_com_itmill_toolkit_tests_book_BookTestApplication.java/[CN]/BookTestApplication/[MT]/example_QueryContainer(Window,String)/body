{
  try {
    Class.forName("org.hsqldb.jdbcDriver");
    final Connection c=DriverManager.getConnection("jdbc:hsqldb:mem:qcexample","sa","");
    Statement st=c.createStatement();
    st.executeQuery("CREATE TABLE Prisoners (id INTEGER, name VARCHAR)");
    st.close();
    for (int i=0; i < 100; i++) {
      st=c.createStatement();
      st.executeQuery("INSERT INTO Prisoners (id, name) VALUES (" + i + ",'I am number "+ (i + 1)+ "')");
      st.close();
    }
    final QueryContainer qc=new QueryContainer("SELECT id,name FROM Prisoners",c);
    Select select=new Select("Select an item");
    select.setContainerDataSource(qc);
    select.setItemCaptionMode(Select.ITEM_CAPTION_MODE_PROPERTY);
    select.setItemCaptionPropertyId("name");
    select.setImmediate(true);
    final Label selection=new Label("Currently selected: -");
    select.addListener(new ValueChangeListener(){
      public void valueChange(      ValueChangeEvent event){
        Integer itemId=(Integer)event.getProperty().getValue();
        Item qrItem=qc.getItem(itemId);
        selection.setValue("Currently selected: result row " + itemId.intValue() + " (id="+ qrItem.getItemProperty("id")+ ", "+ "name="+ qrItem.getItemProperty("name")+ ")");
      }
    }
);
    main.addComponent(select);
    main.addComponent(selection);
  }
 catch (  SQLException e) {
    e.printStackTrace();
  }
catch (  ClassNotFoundException e) {
    e.printStackTrace();
  }
}

{
  double v=min;
  final int coord=vertical ? DOM.eventGetClientY(event) : DOM.eventGetClientX(event);
  final String domProperty=vertical ? "offsetHeight" : "offsetWidth";
  final int handleSize=Integer.parseInt(DOM.getElementProperty(handle,domProperty));
  final double baseSize=Integer.parseInt(DOM.getElementProperty(base,domProperty));
  final double baseOffset=vertical ? DOM.getAbsoluteTop(base) - handleSize / 2 : DOM.getAbsoluteLeft(base) + handleSize / 2;
  if (vertical) {
    v=((baseSize - (coord - baseOffset)) / (baseSize - handleSize)) * (max - min) + min;
  }
 else {
    v=((coord - baseOffset) / (baseSize - handleSize)) * (max - min) + min;
  }
  if (v < min) {
    v=min;
  }
 else   if (v > max) {
    v=max;
  }
  setValue(new Double(v),updateToServer);
}

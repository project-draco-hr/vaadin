{
  final String CAPTION="caption";
  NativeSelect select=new NativeSelect(caption);
  select.addContainerProperty(CAPTION,String.class,"");
  select.setItemCaptionPropertyId(CAPTION);
  select.setNullSelectionAllowed(false);
  for (  String itemCaption : options.keySet()) {
    Item i=select.addItem(options.get(itemCaption));
    i.getItemProperty(CAPTION).setValue(itemCaption);
  }
  select.addListener(new Property.ValueChangeListener(){
    public void valueChange(    ValueChangeEvent event){
      doCommand(command,(T)event.getProperty().getValue());
    }
  }
);
  select.setValue(initialValue);
  select.setImmediate(true);
  return select;
}

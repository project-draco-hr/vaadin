{
  final VaadinSession fieldAppWithCustomIntegerConverter=new AlwaysLockedVaadinSession(null);
  fieldAppWithCustomIntegerConverter.setConverterFactory(new ConverterFactory42());
  VaadinSession.setCurrent(new AlwaysLockedVaadinSession(null));
  LegacyTextField tf=new LegacyTextField("","123"){
    @Override public VaadinSession getSession(){
      return fieldAppWithCustomIntegerConverter;
    }
  }
;
  tf.setConverter(Integer.class);
  Assert.assertEquals(42,tf.getConvertedValue());
}

{
  if (event.getSource() == calendarToggle && !open && !readonly) {
    open=true;
    calendar.updateCalendar();
    popup.setWidth("");
    popup.setHeight("");
    popup.setPopupPositionAndShow(new PositionCallback(){
      public void setPosition(      int offsetWidth,      int offsetHeight){
        final int w=offsetWidth;
        final int h=offsetHeight;
        final int browserWindowWidth=Window.getClientWidth() + Window.getScrollLeft();
        final int browserWindowHeight=Window.getClientHeight() + Window.getScrollTop();
        int t=calendarToggle.getAbsoluteTop();
        int l=calendarToggle.getAbsoluteLeft();
        int extraSpace=30;
        boolean overflowRight=false;
        if (l + +w + extraSpace > browserWindowWidth) {
          overflowRight=true;
          l=browserWindowWidth - w - extraSpace;
        }
        if (t + h + calendarToggle.getOffsetHeight()+ 30 > browserWindowHeight) {
          t=browserWindowHeight - h - calendarToggle.getOffsetHeight()- 30;
          if (!overflowRight) {
            l+=calendarToggle.getOffsetWidth();
          }
        }
        popup.setWidth(w + "px");
        popup.setHeight(h + "px");
        popup.setPopupPosition(l,t + calendarToggle.getOffsetHeight() + 2);
        setFocus(true);
      }
    }
);
  }
}

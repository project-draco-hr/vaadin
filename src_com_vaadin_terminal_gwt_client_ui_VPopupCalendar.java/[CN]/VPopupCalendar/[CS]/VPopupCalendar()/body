{
  super();
  calendarToggle=new Button();
  calendarToggle.setStyleName(CLASSNAME + "-button");
  calendarToggle.setText("");
  calendarToggle.addClickHandler(this);
  calendarToggle.getElement().setTabIndex(-1);
  add(calendarToggle);
  calendar=GWT.create(VCalendarPanel.class);
  calendar.setFocusOutListener(new FocusOutListener(){
    public boolean onFocusOut(    DomEvent event){
      ApplicationConnection.getConsole().log("Focus out event, due to " + event.getNativeEvent().getType());
      event.preventDefault();
      closeCalendarPanel();
      return true;
    }
  }
);
  calendar.setSubmitListener(new SubmitListener(){
    public void onSubmit(){
      updateValue(calendar.getDate());
      buildDate(true);
      closeCalendarPanel();
    }
    public void onCancel(){
      closeCalendarPanel();
    }
  }
);
  popup=new VOverlay(true,true,true);
  popup.setStyleName(VDateField.CLASSNAME + "-popup");
  popup.setWidget(calendar);
  popup.addCloseHandler(this);
  DOM.setElementProperty(calendar.getElement(),"id","PID_VAADIN_POPUPCAL");
  sinkEvents(Event.ONKEYDOWN);
}

{
  Document doc=new Document("");
  DocumentType docType=new DocumentType("html","","","");
  doc.appendChild(docType);
  Element html=doc.createElement("html");
  doc.appendChild(html);
  html.appendChild(doc.createElement("head"));
  Element body=doc.createElement("body");
  html.appendChild(body);
  Element evLayout=doc.createElement("vaadin-vertical-layout");
  evLayout.attr("locale","en_US");
  body.appendChild(evLayout);
  Element ehLayout=doc.createElement("vaadin-horizontal-layout");
  evLayout.appendChild(ehLayout);
  Element eb1=doc.createElement("vaadin-button");
  eb1.attr("locale","en_US");
  ehLayout.appendChild(eb1);
  Element eb2=doc.createElement("vaadin-button");
  eb2.attr("locale","en_GB");
  ehLayout.appendChild(eb2);
  Element eb3=doc.createElement("vaadin-button");
  ehLayout.appendChild(eb3);
  String string=doc.html();
  VerticalLayout vLayout=(VerticalLayout)Design.read(new ByteArrayInputStream(string.getBytes()));
  assertEquals("Wrong locale.",new Locale("en","US"),vLayout.getLocale());
  HorizontalLayout hLayout=(HorizontalLayout)vLayout.getComponent(0);
  assertEquals("The element should have the same locale as its parent.",vLayout.getLocale(),hLayout.getLocale());
  Button b1=(Button)hLayout.getComponent(0);
  assertEquals("Wrong locale.",new Locale("en","US"),b1.getLocale());
  Button b2=(Button)hLayout.getComponent(1);
  assertEquals("Wrong locale.",new Locale("en","GB"),b2.getLocale());
  Button b3=(Button)hLayout.getComponent(2);
  assertEquals("The component should have the same locale as its parent.",hLayout.getLocale(),b3.getLocale());
}

{
  Item newItem=null;
  if (hasChildren() && itsChildren.contains(itemToAddBefore)) {
    int index=itsChildren.indexOf(itemToAddBefore);
    newItem=new Item(caption,icon,command);
    newItem.setParent(this);
    itsChildren.add(index,newItem);
  }
 else {
    newItem=addItem(caption,icon,command);
  }
  requestRepaint();
  return newItem;
}

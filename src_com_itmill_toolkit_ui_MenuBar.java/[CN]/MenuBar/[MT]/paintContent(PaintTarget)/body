{
  super.paintContent(target);
  Stack<Iterator<MenuItem>> iteratorStack=new Stack<Iterator<MenuItem>>();
  target.startTag("options");
  if (submenuIcon != null) {
    target.addAttribute("submenuIcon",submenuIcon);
  }
  target.addAttribute("collapseItems",collapseItems);
  if (collapseItems) {
    target.startTag("moreItem");
    target.addAttribute("text",moreItem.getText());
    if (moreItem.getIcon() != null) {
      target.addAttribute("icon",moreItem.getIcon());
    }
    target.endTag("moreItem");
  }
  target.endTag("options");
  target.startTag("items");
  Iterator<MenuItem> itr=menuItems.iterator();
  while (itr.hasNext()) {
    MenuItem item=(MenuItem)itr.next();
    target.startTag("item");
    target.addAttribute("text",item.getText());
    target.addAttribute("id",item.getId());
    Command command=item.getCommand();
    if (command != null) {
      target.addAttribute("command",true);
    }
 else {
      target.addAttribute("command",false);
    }
    Resource icon=item.getIcon();
    if (icon != null) {
      target.addAttribute("icon",icon);
    }
    if (item.hasChildren()) {
      iteratorStack.push(itr);
      itr=item.getChildren().iterator();
    }
 else {
      target.endTag("item");
    }
    while (!itr.hasNext() && !iteratorStack.empty()) {
      itr=iteratorStack.pop();
      target.endTag("item");
    }
  }
  target.endTag("items");
}

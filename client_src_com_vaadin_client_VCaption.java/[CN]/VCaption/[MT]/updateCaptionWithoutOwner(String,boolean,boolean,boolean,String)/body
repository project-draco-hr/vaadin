{
  boolean wasPlacedAfterComponent=placedAfterComponent;
  placedAfterComponent=true;
  String style=VCaption.CLASSNAME;
  if (disabled) {
    style+=" " + ApplicationConnection.DISABLED_CLASSNAME;
  }
  setStyleName(style);
  if (hasDescription) {
    if (captionText != null) {
      addStyleDependentName("hasdescription");
    }
 else {
      removeStyleDependentName("hasdescription");
    }
  }
  boolean hasIcon=iconURL != null;
  if (hasIcon) {
    if (icon == null) {
      icon=new Icon(client);
      icon.setWidth("0");
      icon.setHeight("0");
      DOM.insertChild(getElement(),icon.getElement(),getInsertPosition(InsertPosition.ICON));
    }
    placedAfterComponent=false;
    icon.setUri(iconURL);
  }
 else   if (icon != null) {
    DOM.removeChild(getElement(),icon.getElement());
    icon=null;
  }
  if (caption != null) {
    if (captionText == null) {
      captionText=DOM.createDiv();
      captionText.setClassName("v-captiontext");
      DOM.insertChild(getElement(),captionText,getInsertPosition(InsertPosition.CAPTION));
    }
    placedAfterComponent=false;
    if (caption.trim().equals("")) {
      if (!hasIcon && !hasError) {
        captionText.setInnerHTML("&nbsp;");
      }
    }
 else {
      DOM.setInnerText(captionText,caption);
    }
  }
 else   if (captionText != null) {
    DOM.removeChild(getElement(),captionText);
    captionText=null;
  }
  if (hasError) {
    if (errorIndicatorElement == null) {
      errorIndicatorElement=DOM.createDiv();
      DOM.setInnerHTML(errorIndicatorElement,"&nbsp;");
      DOM.setElementProperty(errorIndicatorElement,"className","v-errorindicator");
      DOM.insertChild(getElement(),errorIndicatorElement,getInsertPosition(InsertPosition.ERROR));
    }
  }
 else   if (errorIndicatorElement != null) {
    getElement().removeChild(errorIndicatorElement);
    errorIndicatorElement=null;
  }
  return (wasPlacedAfterComponent != placedAfterComponent);
}

{
  Collection xslFiles=new LinkedList();
  if (this.theme != null) {
    if (webAdapterServlet.isDebugMode(null)) {
      Log.info("ServletThemeSource: Loading theme: " + theme);
    }
    InputStream entry=context.getResourceAsStream(this.path + Theme.DESCRIPTIONFILE);
    try {
      if (entry != null) {
        this.theme=new Theme(entry);
      }
    }
 catch (    Exception e) {
      throw new ThemeException("ServletThemeSource: Failed to load '" + path + "': "+ e);
    }
 finally {
      if (entry != null)       try {
        entry.close();
      }
 catch (      IOException ignored) {
      }
    }
    Collection fileNames=theme.getFileNames(type,Theme.MODE_XSLT);
    for (Iterator i=fileNames.iterator(); i.hasNext(); ) {
      String entryName=(String)i.next();
      if (entryName.endsWith(".xsl")) {
        entry=context.getResourceAsStream((this.path + entryName));
        xslFiles.add(new XSLStream(entryName,entry));
      }
    }
  }
  return xslFiles;
}

{
  final HorizontalSplitPanel leftSide=new HorizontalSplitPanel();
  leftSide.setHeight("100%");
  final IndexedContainer dataSource=new IndexedContainer();
  dataSource.addContainerProperty(propId,String.class,null);
  dataSource.addContainerProperty(propId2,String.class,null);
  final Object itemId=dataSource.addItem();
  dataSource.getItem(itemId).getItemProperty(propId).setValue("Very long value that makes a scrollbar appear for sure");
  dataSource.getItem(itemId).getItemProperty(propId2).setValue("Very long value that makes a scrollbar appear for sure");
  for (int i=0; i < 150; i++) {
    Object id=dataSource.addItem();
    dataSource.getItem(id).getItemProperty(propId).setValue((i == 100 ? "Very long value that makes a scrollbar appear for sure" : "Short"));
    dataSource.getItem(id).getItemProperty(propId2).setValue("Short");
  }
  table.setSizeFull();
  table.setContainerDataSource(dataSource);
  table.setVisibleColumns(new Object[]{propId});
  leftSide.setSecondComponent(table);
  Button button=new Button("Change col value to short");
  button.addListener(new Button.ClickListener(){
    @Override public void buttonClick(    Button.ClickEvent event){
      if (isLong) {
        dataSource.getItem(itemId).getItemProperty(propId).setValue("Short value");
        dataSource.getItem(itemId).getItemProperty(propId2).setValue("Short value");
        isLong=false;
      }
 else {
        dataSource.getItem(itemId).getItemProperty(propId).setValue("Very long value that makes a scrollbar appear for sure");
        dataSource.getItem(itemId).getItemProperty(propId2).setValue("Very long value that makes a scrollbar appear for sure");
        isLong=true;
      }
      table.markAsDirty();
    }
  }
);
  VerticalLayout ol=new VerticalLayout();
  ol.addComponent(button);
  leftSide.setFirstComponent(ol);
  CheckBox checkBox=new CheckBox("Two col");
  checkBox.addListener(new ValueChangeListener(){
    @Override public void valueChange(    ValueChangeEvent event){
      if ((Boolean)event.getProperty().getValue()) {
        table.setVisibleColumns(new Object[]{propId,propId2});
      }
 else {
        table.setVisibleColumns(new Object[]{propId});
      }
    }
  }
);
  ol.addComponent(checkBox);
  return leftSide;
}

{
  if (ServletPortletHelper.isUIDLRequest(request)) {
    if (caption != null) {
      caption="\"" + JsonPaintTarget.escapeJSON(caption) + "\"";
    }
    if (details != null) {
      if (message == null) {
        message=details;
      }
 else {
        message+="<br/><br/>" + details;
      }
    }
    if (message != null) {
      message="\"" + JsonPaintTarget.escapeJSON(message) + "\"";
    }
    if (url != null) {
      url="\"" + JsonPaintTarget.escapeJSON(url) + "\"";
    }
    String output="for(;;);[{\"changes\":[], \"meta\" : {" + "\"appError\": {" + "\"caption\":" + caption + ","+ "\"message\" : "+ message+ ","+ "\"url\" : "+ url+ "}}, \"resources\": {}, \"locales\":[]}]";
    writeResponse(response,"application/json; charset=UTF-8",output);
  }
 else {
    String output="";
    if (url != null) {
      output+="<a href=\"" + url + "\">";
    }
    if (caption != null) {
      output+="<b>" + caption + "</b><br/>";
    }
    if (message != null) {
      output+=message;
      output+="<br/><br/>";
    }
    if (details != null) {
      output+=details;
      output+="<br/><br/>";
    }
    if (url != null) {
      output+="</a>";
    }
    writeResponse(response,"text/html; charset=UTF-8",output);
  }
}

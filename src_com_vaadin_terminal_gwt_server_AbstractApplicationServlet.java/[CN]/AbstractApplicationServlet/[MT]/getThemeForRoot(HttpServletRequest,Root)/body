{
  String themeName;
  if (request.getParameter(URL_PARAMETER_THEME) != null) {
    themeName=request.getParameter(URL_PARAMETER_THEME);
  }
 else {
    themeName=root.getApplication().getThemeForRoot(root);
  }
  if (themeName == null) {
    themeName=getDefaultTheme();
  }
  themeName=stripSpecialChars(themeName);
  return themeName;
}

{
  if ("jar".equals(resourceUrl.getProtocol())) {
    if (!resourceUrl.getPath().contains("!/VAADIN/")) {
      logger.info("Blocked attempt to access a JAR entry not starting with /VAADIN/: " + resourceUrl);
      return false;
    }
    logger.fine("Accepted access to a JAR entry using a class loader: " + resourceUrl);
    return true;
  }
 else   if ("file".equals(resourceUrl.getProtocol())) {
    if (!resourceUrl.getPath().contains("/VAADIN/") || resourceUrl.getPath().contains("/../")) {
      logger.info("Blocked attempt to access file: " + resourceUrl);
      return false;
    }
    logger.fine("Accepted access to a file using a class loader: " + resourceUrl);
    return true;
  }
  return false;
}

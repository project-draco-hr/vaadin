{
  if ("jar".equals(resourceUrl.getProtocol())) {
    if (!resourceUrl.getPath().contains("!/VAADIN/")) {
      logger.warning("Attempted access to a JAR entry not starting with /VAADIN/: " + resourceUrl);
      return false;
    }
    return true;
  }
 else   if ("file".equals(resourceUrl.getProtocol())) {
    if (!resourceUrl.getPath().contains("/VAADIN/") || resourceUrl.getPath().contains("/../")) {
      logger.info("Blocked attempted access to the file : " + resourceUrl);
      return false;
    }
    logger.fine("Accepting access to a file using a class loader: " + resourceUrl);
    return true;
  }
  return false;
}

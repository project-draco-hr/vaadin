{
  Validate.notEmpty(tag);
  Validate.notEmpty(key);
  Validate.notNull(protocols);
  TagName tagName=TagName.valueOf(tag);
  AttributeKey attrKey=AttributeKey.valueOf(key);
  Map<AttributeKey,Set<Protocol>> attrMap;
  Set<Protocol> protSet;
  if (this.protocols.containsKey(tagName)) {
    attrMap=this.protocols.get(tagName);
  }
 else {
    attrMap=new HashMap<AttributeKey,Set<Protocol>>();
    this.protocols.put(tagName,attrMap);
  }
  if (attrMap.containsKey(attrKey)) {
    protSet=attrMap.get(attrKey);
  }
 else {
    protSet=new HashSet<Protocol>();
    attrMap.put(attrKey,protSet);
  }
  for (  String protocol : protocols) {
    Validate.notEmpty(protocol);
    Protocol prot=Protocol.valueOf(protocol);
    protSet.add(prot);
  }
  return this;
}

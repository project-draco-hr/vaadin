{
  final Window main=new Window("#1804");
  setMainWindow(main);
  com.itmill.toolkit.ui.Select s;
  s=new Select("Select with null selection allowed; required=true");
  s.setNullSelectionAllowed(true);
  listOfAllFields.add(s);
  s=new Select("Select with null selection NOT allowed; required=true");
  s.setNullSelectionAllowed(false);
  listOfAllFields.add(s);
  s=new Select("Testcase from the ticket #1804");
  s.setWidth(190);
  s.setNullSelectionAllowed(false);
  TestPojo myPojo=new TestPojo();
  Select selectToBeBoundToExternalDatasource=s;
  s.addValidator(new EmptyStringValidator("Selection required for test-field"));
  listOfAllFields.add(s);
  for (Iterator i=listOfAllFields.iterator(); i.hasNext(); ) {
    s=(Select)i.next();
    main.addComponent(s);
    s.addItem("foo");
    s.addItem("");
    s.addItem("bar");
    if (s.isNullSelectionAllowed()) {
      s.addItem("<null>");
      s.setNullSelectionItemId("<null>");
    }
    s.setImmediate(true);
    s.setRequired(true);
  }
  selectToBeBoundToExternalDatasource.setPropertyDataSource(new MethodProperty(myPojo,"id"));
  Button checkValidity=new Button("Check validity of the fields");
  main.addComponent(checkValidity);
  checkValidity.addListener(new Button.ClickListener(){
    public void buttonClick(    ClickEvent event){
      StringBuffer msg=new StringBuffer();
      for (java.util.Iterator i=listOfAllFields.iterator(); i.hasNext(); ) {
        AbstractField af=(AbstractField)i.next();
        msg.append("<h1>" + af.getCaption() + "</h1>\n");
        msg.append("Value=" + af.getValue() + "<br/>\n");
        if (af.isValid()) {
          msg.append("VALID\n<hr/>");
        }
 else {
          msg.append("INVALID<br/><i>" + af.getErrorMessage() + "</i><hr/>");
        }
      }
      Window w=new Window("Status of the fields");
      w.setModal(true);
      w.addComponent(new Label(msg.toString(),Label.CONTENT_XHTML));
      main.addWindow(w);
    }
  }
);
}

{
  ComboBoxElement comboBox=$(ComboBoxElement.class).all().get(3);
  assertEquals("correct value not displayed","Null item",comboBox.findElement(By.tagName("input")).getAttribute("value"));
  assertFalse("suggestions not found even if there should be several",comboBox.getPopupSuggestions().isEmpty());
  WebElement popup=driver.findElement(By.className("v-filterselect-suggestpopup"));
  List<WebElement> filteredItems=popup.findElement(By.className("v-filterselect-suggestmenu")).findElements(By.className("gwt-MenuItem"));
  assertEquals("unexpected amount of suggestions found",4,filteredItems.size());
  assertEquals("wrong filtering result","Null item",filteredItems.get(0).getText());
  assertEquals("wrong filtering result","Value 1",filteredItems.get(1).getText());
  assertEquals("wrong filtering result","Value 3",filteredItems.get(3).getText());
  assertEquals("wrong selection","Null item",popup.findElement(By.className("v-filterselect-suggestmenu")).findElement(By.className("gwt-MenuItem-selected")).getText());
  filteredItems.get(1).click();
  assertFalse("popup found when there should be none",comboBox.isElementPresent(By.vaadin("#popup")));
  assertEquals("correct selection not found","Value 1",comboBox.findElement(By.tagName("input")).getAttribute("value"));
  comboBox.openPopup();
  waitForElementPresent(By.className("v-filterselect-suggestmenu"));
  popup=driver.findElement(By.className("v-filterselect-suggestpopup"));
  filteredItems=popup.findElement(By.className("v-filterselect-suggestmenu")).findElements(By.className("gwt-MenuItem"));
  assertEquals("unexpected amount of suggestions found",4,filteredItems.size());
  assertEquals("wrong selection","Value 1",popup.findElement(By.className("v-filterselect-suggestmenu")).findElement(By.className("gwt-MenuItem-selected")).getText());
  filteredItems.get(0).click();
  assertFalse("popup found when there should be none",comboBox.isElementPresent(By.vaadin("#popup")));
}

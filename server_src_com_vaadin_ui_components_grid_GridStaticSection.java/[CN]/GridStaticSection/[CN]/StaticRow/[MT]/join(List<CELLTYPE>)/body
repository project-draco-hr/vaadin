{
  for (  CELLTYPE cell : cells) {
    if (getCellGroupForCell(cell) != null) {
      throw new IllegalArgumentException("Cell already merged");
    }
 else     if (!this.cells.containsValue(cell)) {
      throw new IllegalArgumentException("Cell does not exist on this row");
    }
  }
  if (cellsInContinuousRange(cells)) {
    List<String> columnGroup=new ArrayList<String>();
    for (    CELLTYPE cell : cells) {
      columnGroup.add(cell.getColumnId());
    }
    rowState.cellGroups.add(columnGroup);
    cellGroups.add(cells);
    return cells.get(0);
  }
 else {
    throw new IllegalArgumentException("Cells are in invalid order or not in a contiunous range");
  }
}

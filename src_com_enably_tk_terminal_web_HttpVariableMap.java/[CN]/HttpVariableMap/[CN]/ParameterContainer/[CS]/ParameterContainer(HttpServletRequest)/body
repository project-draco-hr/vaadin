{
  for (Enumeration e=req.getParameterNames(); e.hasMoreElements(); ) {
    String paramName=(String)e.nextElement();
    String[] paramValues=req.getParameterValues(paramName);
    addParam(paramName,paramValues);
  }
  try {
    parser=new ServletMultipartRequest(req,MultipartRequest.MAX_READ_BYTES);
  }
 catch (  IllegalArgumentException ignored) {
    parser=null;
  }
  if (parser != null) {
    for (Enumeration e=parser.getFileParameterNames(); e.hasMoreElements(); ) {
      String paramName=(String)e.nextElement();
      addParam(paramName,null);
    }
    for (Enumeration e=parser.getParameterNames(); e.hasMoreElements(); ) {
      String paramName=(String)e.nextElement();
      Enumeration val=parser.getURLParameters(paramName);
      LinkedList l=new LinkedList();
      while (val.hasMoreElements())       l.addLast(val.nextElement());
      String[] s=new String[l.size()];
      Iterator i=l.iterator();
      for (int j=0; j < s.length; j++)       s[j]=(String)i.next();
      addParam(paramName,s);
    }
  }
}

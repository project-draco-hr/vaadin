{
  Application application=context.getApplication();
  Integer uiId=context.getUIId();
  JSONObject appConfig=new JSONObject();
  if (uiId != null) {
    appConfig.put(UIConstants.UI_ID_PARAMETER,uiId);
  }
  if (context.getThemeName() != null) {
    appConfig.put("themeUri",getThemeUri(context,context.getThemeName()));
  }
  JSONObject versionInfo=new JSONObject();
  versionInfo.put("vaadinVersion",Version.getFullVersion());
  versionInfo.put("applicationVersion",application.getVersion());
  appConfig.put("versionInfo",versionInfo);
  appConfig.put("widgetset",context.getWidgetsetName());
  if (uiId == null || application.isUIInitPending(uiId.intValue())) {
    appConfig.put("initialPath",context.getRequest().getRequestPathInfo());
    Map<String,String[]> parameterMap=context.getRequest().getParameterMap();
    appConfig.put("initialParams",parameterMap);
  }
 else {
    appConfig.put("uidl",getInitialUIDL(context.getRequest(),context.getUI()));
  }
  return appConfig;
}

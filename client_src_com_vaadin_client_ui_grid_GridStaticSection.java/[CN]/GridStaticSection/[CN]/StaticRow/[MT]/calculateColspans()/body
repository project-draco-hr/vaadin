{
  for (  CELLTYPE cell : this.cells.values()) {
    cell.setColspan(1);
  }
  for (  List<GridColumn<?,?>> group : cellGroups) {
    int firstVisibleColumnInGroup=-1;
    int lastVisibleColumnInGroup=-1;
    int hiddenInsideGroup=0;
    for (int i=0; i < group.size(); i++) {
      if (group.get(i).isVisible()) {
        lastVisibleColumnInGroup=i;
        if (firstVisibleColumnInGroup == -1) {
          firstVisibleColumnInGroup=i;
        }
      }
 else       if (firstVisibleColumnInGroup != -1) {
        hiddenInsideGroup++;
      }
    }
    if (firstVisibleColumnInGroup == -1 || lastVisibleColumnInGroup == -1 || firstVisibleColumnInGroup == lastVisibleColumnInGroup) {
      continue;
    }
    GridColumn<?,?> firstVisibleColumn=group.get(firstVisibleColumnInGroup);
    CELLTYPE firstVisibleCell=getCell(firstVisibleColumn);
    firstVisibleCell.setColspan(lastVisibleColumnInGroup - firstVisibleColumnInGroup - hiddenInsideGroup + 1);
  }
}

{
  for (  CELLTYPE cell : this.cells.values()) {
    cell.setColspan(1);
  }
  List<GridColumn<?,?>> columnOrder=new ArrayList<GridColumn<?,?>>(section.grid.getColumns());
  for (  Set<GridColumn<?,?>> group : cellGroups.keySet()) {
    if (!checkCellGroupAndOrder(columnOrder,group)) {
      cellGroups.get(group).setColspan(1);
    }
 else {
      int colSpan=group.size();
      for (      GridColumn<?,?> column : group) {
        if (!column.isVisible()) {
          --colSpan;
        }
      }
      cellGroups.get(group).setColspan(colSpan);
    }
  }
}

{
  if (formatString != null && locale != null) {
    return Json.create(String.format(locale,formatString,value));
  }
 else   if (numberFormat != null) {
    return Json.create(numberFormat.format(value));
  }
 else {
    throw new IllegalStateException(String.format("Internal bug: " + "%s is in an illegal state: " + "[locale: %s, numberFormat: %s, formatString: %s]",getClass().getSimpleName(),locale,numberFormat,formatString));
  }
}

{
  final Layout layout=new VerticalLayout();
  final Label label=new Label("Instructions to reproduce:\n" + "  - Open this application in two browser windows\n" + "  - Click the Button in first Window\n"+ "  - Go to the second Window\n"+ "     - Click the arrow in the Select\n"+ "  --> The opened list correctly shows the new value but the old one is shown in the \"input\" part");
  label.setContentMode(ContentMode.PREFORMATTED);
  layout.addComponent(label);
  final Select select=new Select("Test Select");
  select.setWidth("100px");
  select.setImmediate(true);
  select.setNullSelectionAllowed(false);
  select.addItem("1");
  select.addItem("2");
  select.addItem("3");
  final ObjectProperty<String> valueProperty=new ObjectProperty<String>("1",String.class);
  select.setPropertyDataSource(valueProperty);
  layout.addComponent(select);
  globalValue.addListener(new Property.ValueChangeListener(){
    @Override public void valueChange(    Property.ValueChangeEvent event){
      Object value=event.getProperty().getValue();
      valueProperty.setValue((null != value) ? value.toString() : null);
    }
  }
);
  final Button changeValueButton=new Button("Change Value to 2");
  changeValueButton.addListener(new Button.ClickListener(){
    @Override public void buttonClick(    Button.ClickEvent event){
      globalValue.setValue("2");
    }
  }
);
  layout.addComponent(changeValueButton);
  return layout;
}

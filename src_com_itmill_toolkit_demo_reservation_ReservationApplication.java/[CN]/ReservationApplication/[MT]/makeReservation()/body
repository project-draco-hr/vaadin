{
  try {
    Item resource=getActiveResource();
    if (resource != null) {
      db.addReservation(resource,0,(Date)reservedFrom.getValue(),(Date)reservedTo.getValue(),(String)description.getValue());
      statusLabel.setCaption("Success!");
      statusLabel.setValue("You have reserved the resource for the selected period.");
    }
 else {
      showMessage("No resource selected","Please select a resource (or category) to reserve.");
    }
  }
 catch (  ResourceNotAvailableException e) {
    showMessage("Reservation failed","The selected resource was not available for the selected period.");
  }
  refreshReservations();
}

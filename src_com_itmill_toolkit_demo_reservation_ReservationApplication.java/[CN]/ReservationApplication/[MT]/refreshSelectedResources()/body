{
  Item resource=null;
  try {
    resource=getActiveResource();
  }
 catch (  ResourceNotAvailableException e) {
    resourceName.setValue("Not available");
    reservationButton.setEnabled(false);
    return;
  }
  map.clear();
  if (resource == null) {
    resourceName.setValue("Choose resource");
    reservationButton.setEnabled(false);
    map.setContainerDataSource(db.getResources(null));
    map.setZoomLevel(12);
  }
 else {
    String name=(String)resource.getItemProperty(SampleDB.Resource.PROPERTY_ID_NAME).getValue();
    String desc=(String)resource.getItemProperty(SampleDB.Resource.PROPERTY_ID_DESCRIPTION).getValue();
    resourceName.setValue(name);
    Double x=(Double)resource.getItemProperty(SampleDB.Resource.PROPERTY_ID_LOCATIONX).getValue();
    Double y=(Double)resource.getItemProperty(SampleDB.Resource.PROPERTY_ID_LOCATIONY).getValue();
    if (x != null && y != null) {
      map.addMarker(name + "<br/>" + desc,new Point2D.Double(x.doubleValue(),y.doubleValue()));
      map.setZoomLevel(14);
    }
    reservationButton.setEnabled(true);
  }
}

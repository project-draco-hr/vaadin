{
  Item resource=null;
  try {
    resource=getActiveResource();
  }
 catch (  final ResourceNotAvailableException e) {
    if (alertIfNotAvailable) {
      getMainWindow().showNotification("Not available","Please choose another resource or time period.",Notification.TYPE_HUMANIZED_MESSAGE);
    }
    refreshReservations();
    return;
  }
  map.clear();
  if (resource == null) {
    resourceName.setCaption("Choose resource above");
    resourceName.setValue("");
    map.setContainerDataSource(db.getResources(null));
    map.setZoomLevel(1);
  }
 else {
    String name=(String)resource.getItemProperty(SampleDB.Resource.PROPERTY_ID_NAME).getValue();
    String desc=(String)resource.getItemProperty(SampleDB.Resource.PROPERTY_ID_DESCRIPTION).getValue();
    resourceName.setCaption(name);
    resourceName.setValue(desc);
    final LinkedList srs=resourcePanel.getSelectedResources();
    for (final Iterator it=srs.iterator(); it.hasNext(); ) {
      resource=(Item)it.next();
      name=(String)resource.getItemProperty(SampleDB.Resource.PROPERTY_ID_NAME).getValue();
      desc=(String)resource.getItemProperty(SampleDB.Resource.PROPERTY_ID_DESCRIPTION).getValue();
      final Double x=(Double)resource.getItemProperty(SampleDB.Resource.PROPERTY_ID_LOCATIONX).getValue();
      final Double y=(Double)resource.getItemProperty(SampleDB.Resource.PROPERTY_ID_LOCATIONY).getValue();
      if (x != null && y != null) {
        map.addMarker(name + "<br/>" + desc,new Point2D.Double(x.doubleValue(),y.doubleValue()));
      }
    }
    map.setZoomLevel((srs.size() == 1 ? 14 : 9));
  }
}

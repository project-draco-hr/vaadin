{
  String uri=request.getPathInfo();
  if (uri == null) {
    uri="";
  }
 else {
    while (uri.startsWith("/") && uri.length() > 0) {
      uri=uri.substring(1);
    }
  }
  if (isApplicationRunnerServlet) {
    if (uri.contains("/")) {
      uri=uri.replaceFirst(applicationRunnerClassname + "/","");
    }
 else {
      uri="";
    }
  }
  try {
    URL context=application.getURL();
    if (window == application.getMainWindow()) {
      DownloadStream stream=null;
      stream=application.handleURI(context,uri);
      if (stream == null) {
        stream=window.handleURI(context,uri);
      }
      return stream;
    }
 else {
      final int index=uri.indexOf('/');
      if (index > 0) {
        String prefix=uri.substring(0,index);
        URL windowContext;
        windowContext=new URL(context,prefix + "/");
        final String windowUri=(uri.length() > prefix.length() + 1) ? uri.substring(prefix.length() + 1) : "";
        return window.handleURI(windowContext,windowUri);
      }
 else {
        return null;
      }
    }
  }
 catch (  final Throwable t) {
    application.terminalError(new URIHandlerErrorImpl(application,t));
    return null;
  }
}

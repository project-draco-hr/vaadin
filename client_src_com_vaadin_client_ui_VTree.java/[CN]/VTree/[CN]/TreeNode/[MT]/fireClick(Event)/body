{
  if (!treeHasFocus) {
    if (BrowserInfo.get().isOpera()) {
      if (focusedNode == null) {
        getNodeByKey(key).setFocused(true);
      }
 else {
        focusedNode.setFocused(true);
      }
    }
 else {
      focus();
    }
  }
  final MouseEventDetails details=MouseEventDetailsBuilder.buildMouseEventDetails(evt);
  executeEventCommand(new ScheduledCommand(){
    @Override public void execute(){
      sendClickEventNow=true;
      if (details.getButton() == MouseButton.LEFT && selectable) {
        if (immediate) {
          sendClickEventNow=false;
          if (isSelected() && selectedIds.size() == 1 && !isNullSelectionAllowed) {
            sendClickEventNow=true;
          }
        }
        client.updateVariable(paintableId,"clickedKey",key,false);
        client.updateVariable(paintableId,"clickEvent",details.toString(),false);
      }
 else {
        client.updateVariable(paintableId,"clickedKey",key,false);
        client.updateVariable(paintableId,"clickEvent",details.toString(),sendClickEventNow);
        sendClickEventNow=false;
      }
    }
  }
);
}

{
  for (int i=0; i < COLUMNS; i++) {
    final int index=i;
    final GridColumn<?,List<Data>> column=grid.getColumn(index);
    addMenuCommand("Visible",new ScheduledCommand(){
      @Override public void execute(){
        column.setVisible(!column.isVisible());
      }
    }
,"Component","Columns","Column " + i);
    addMenuCommand("Sortable",new ScheduledCommand(){
      @Override public void execute(){
        column.setSortable(!column.isSortable());
      }
    }
,"Component","Columns","Column " + i);
    addMenuCommand("Frozen",new ScheduledCommand(){
      @Override public void execute(){
        if (column.equals(grid.getLastFrozenColumn())) {
          grid.setLastFrozenColumn(null);
        }
 else {
          grid.setLastFrozenColumn(column);
        }
      }
    }
,"Component","Columns","Column " + i);
    addMenuCommand("auto",new ScheduledCommand(){
      @Override public void execute(){
        column.setWidth(-1);
      }
    }
,"Component","Columns","Column " + i,"Width");
    addMenuCommand("50px",new ScheduledCommand(){
      @Override public void execute(){
        column.setWidth(50);
      }
    }
,"Component","Columns","Column " + i,"Width");
    addMenuCommand("200px",new ScheduledCommand(){
      @Override public void execute(){
        column.setWidth(200);
      }
    }
,"Component","Columns","Column " + i,"Width");
    addMenuCommand("Text Header",new ScheduledCommand(){
      @Override public void execute(){
        column.setHeader("Text Header");
      }
    }
,"Component","Columns","Column " + i,"Header Type");
    addMenuCommand("HTML Header",new ScheduledCommand(){
      @Override public void execute(){
        grid.getHeader().getRow(0).getCell(column).setHtml("<b>HTML Header</b>");
      }
    }
,"Component","Columns","Column " + i,"Header Type");
    addMenuCommand("Widget Header",new ScheduledCommand(){
      @Override public void execute(){
        final Button button=new Button("Button Header");
        button.addClickHandler(new ClickHandler(){
          @Override public void onClick(          ClickEvent event){
            button.setText("Clicked");
          }
        }
);
        grid.getHeader().getRow(0).getCell(column).setWidget(button);
      }
    }
,"Component","Columns","Column " + i,"Header Type");
    addMenuCommand("Text Footer",new ScheduledCommand(){
      @Override public void execute(){
        grid.getFooter().getRow(0).getCell(column).setText("Text Footer");
      }
    }
,"Component","Columns","Column " + i,"Footer Type");
    addMenuCommand("HTML Footer",new ScheduledCommand(){
      @Override public void execute(){
        grid.getFooter().getRow(0).getCell(column).setHtml("<b>HTML Footer</b>");
      }
    }
,"Component","Columns","Column " + i,"Footer Type");
    addMenuCommand("Widget Footer",new ScheduledCommand(){
      @Override public void execute(){
        final Button button=new Button("Button Footer");
        button.addClickHandler(new ClickHandler(){
          @Override public void onClick(          ClickEvent event){
            button.setText("Clicked");
          }
        }
);
        grid.getFooter().getRow(0).getCell(column).setWidget(button);
      }
    }
,"Component","Columns","Column " + i,"Footer Type");
  }
}

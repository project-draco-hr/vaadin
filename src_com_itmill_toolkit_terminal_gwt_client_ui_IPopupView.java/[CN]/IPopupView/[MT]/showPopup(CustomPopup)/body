{
  int windowTop=RootPanel.get().getAbsoluteTop();
  int windowLeft=RootPanel.get().getAbsoluteLeft();
  int windowRight=windowLeft + RootPanel.get().getOffsetWidth();
  int windowBottom=windowTop + RootPanel.get().getOffsetHeight();
  int offsetWidth=popup.getOffsetWidth();
  int offsetHeight=popup.getOffsetHeight();
  int hostHorizontalCenter=IPopupView.this.getAbsoluteLeft() + IPopupView.this.getOffsetWidth() / 2;
  int hostVerticalCenter=IPopupView.this.getAbsoluteTop() + IPopupView.this.getOffsetHeight() / 2;
  int left=hostHorizontalCenter - offsetWidth / 2;
  int top=hostVerticalCenter - offsetHeight / 2;
  if ((left + offsetWidth) > windowRight) {
    left-=(left + offsetWidth) - windowRight;
  }
  if ((top + offsetHeight) > windowBottom) {
    top-=(top + offsetHeight) - windowBottom;
  }
  popup.setPopupPosition(left,top);
  popup.setVisible(true);
}

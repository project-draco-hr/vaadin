{
  super.paintContent(target);
  if (this.minDate != null) {
    target.addAttribute("min",String.valueOf(this.minDate.getTime()));
  }
  if (this.maxDate != null) {
    target.addAttribute("max",String.valueOf(this.maxDate.getTime()));
  }
  if (this.dataSource != null) {
    target.startTag("items");
    int month=new Date().getMonth();
    Object value=getValue();
    if (value != null && value instanceof Date) {
      month=((Date)value).getMonth();
    }
    for (Iterator it=this.dataSource.getItemIds().iterator(); it.hasNext(); ) {
      Object itemId=it.next();
      Item item=(Item)this.dataSource.getItem(itemId);
      Property p=item.getItemProperty(this.itemStartPropertyId);
      Date start=(Date)p.getValue();
      Date end=start;
      if (this.itemEndPropertyId != null) {
        p=item.getItemProperty(this.itemEndPropertyId);
        end=(Date)p.getValue();
        if (end == null) {
          end=start;
        }
 else         if (end.before(start)) {
          Date tmp=start;
          start=end;
          end=tmp;
        }
      }
      if (start != null) {
        if ((start.getMonth() <= month || end.getMonth() >= month)) {
          target.startTag("item");
          target.addAttribute("id",itemId.hashCode());
          target.addAttribute("start","" + start.getTime());
          if (end != start) {
            target.addAttribute("end","" + end.getTime());
          }
          if (this.itemTitlePropertyId != null) {
            p=item.getItemProperty(this.itemTitlePropertyId);
            Object val=p.getValue();
            if (val != null) {
              target.addAttribute("title",val.toString());
            }
          }
          if (this.itemDescriptionPropertyId != null) {
            p=item.getItemProperty(this.itemDescriptionPropertyId);
            Object val=p.getValue();
            if (val != null) {
              target.addAttribute("description",val.toString());
            }
          }
          if (this.itemNotimePropertyId != null) {
            p=item.getItemProperty(this.itemNotimePropertyId);
            Object val=p.getValue();
            if (val != null) {
              target.addAttribute("notime",((Boolean)val).booleanValue());
            }
          }
          target.endTag("item");
        }
      }
    }
    target.endTag("items");
  }
}

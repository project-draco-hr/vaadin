{
switch (DOM.eventGetType(event)) {
case Event.ONMOUSEDOWN:
    if (!isActive()) {
      bringToFront();
    }
  dragging=true;
startX=DOM.eventGetScreenX(event);
startY=DOM.eventGetScreenY(event);
origX=DOM.getAbsoluteLeft(getElement());
origY=DOM.getAbsoluteTop(getElement());
DOM.eventPreventDefault(event);
DOM.addEventPreview(this);
break;
case Event.ONMOUSEUP:
dragging=false;
DOM.removeEventPreview(this);
break;
case Event.ONMOUSEMOVE:
if (dragging) {
int x=DOM.eventGetScreenX(event) - startX + origX;
int y=DOM.eventGetScreenY(event) - startY + origY;
setPopupPosition(x,y);
DOM.eventPreventDefault(event);
}
break;
default :
break;
}
}

{
  if (tagName == null)   throw new NullPointerException();
  if (this.closed)   throw new PaintException("Attempted to write to a closed PaintTarget.");
  JsonTag parent=(JsonTag)openJsonTags.pop();
  if (parent != null)   tagName=parent.postfixChildtag(tagName,false);
  String lastTag="";
  lastTag=(String)mOpenTags.pop();
  if (!tagName.equalsIgnoreCase(lastTag))   throw new PaintException("Invalid UIDL: wrong ending tag: '" + tagName + "' expected: '"+ lastTag+ "'.");
  if (tag.childrenArrayOpen)   tag.closeChildrenArray();
  append(tag.getData());
  append(tag.attributesAsJsonObject());
  append(tag.variablesAsJsonObject());
  append("}");
  tag=parent;
  flush();
}

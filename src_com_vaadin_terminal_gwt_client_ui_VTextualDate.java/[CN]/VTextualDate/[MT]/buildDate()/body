{
  removeStyleName(PARSE_ERROR_CLASSNAME);
  String dateText;
  if (date != null) {
    String formatStr=getFormatString();
    if (formatStr.contains("MMMM")) {
      @SuppressWarnings("deprecation") String monthName=getDateTimeService().getMonth(date.getMonth());
      if (monthName != null) {
        formatStr=formatStr.replaceAll("[M]{4,}","'" + monthName + "'");
      }
    }
    if (formatStr.contains("MMM")) {
      @SuppressWarnings("deprecation") String monthName=getDateTimeService().getShortMonth(date.getMonth());
      if (monthName != null) {
        formatStr=formatStr.replaceAll("[M]{3,}","'" + monthName + "'");
      }
    }
    DateTimeFormat format=DateTimeFormat.getFormat(formatStr);
    dateText=format.format(date);
  }
 else {
    dateText="";
  }
  setText(dateText);
  text.setEnabled(enabled);
  text.setReadOnly(readonly);
  if (readonly) {
    text.addStyleName("v-readonly");
  }
 else {
    text.removeStyleName("v-readonly");
  }
}

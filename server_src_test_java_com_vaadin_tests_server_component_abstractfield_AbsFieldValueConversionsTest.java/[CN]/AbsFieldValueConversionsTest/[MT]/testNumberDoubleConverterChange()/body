{
  final VaadinSession a=new AlwaysLockedVaadinSession(null);
  VaadinSession.setCurrent(a);
  LegacyTextField tf=new LegacyTextField(){
    @Override public VaadinSession getSession(){
      return a;
    }
  }
;
  NumberBean nb=new NumberBean();
  nb.setNumber(490);
  tf.setPropertyDataSource(new MethodProperty<Number>(nb,"number"));
  assertEquals(490,tf.getPropertyDataSource().getValue());
  assertEquals("490",tf.getValue());
  LegacyConverter c1=tf.getConverter();
  tf.setPropertyDataSource(new MethodProperty<Number>(nb,"number"));
  LegacyConverter c2=tf.getConverter();
  assertTrue("StringToInteger converter is ok for integer types and should stay even though property is changed",c1 == c2);
  assertEquals(490,tf.getPropertyDataSource().getValue());
  assertEquals("490",tf.getValue());
}

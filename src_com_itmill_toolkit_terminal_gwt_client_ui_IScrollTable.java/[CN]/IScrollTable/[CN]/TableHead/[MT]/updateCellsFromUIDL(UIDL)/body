{
  Iterator it=uidl.getChildIterator();
  HashSet<String> updated=new HashSet<String>();
  updated.add("0");
  while (it.hasNext()) {
    final UIDL col=(UIDL)it.next();
    final String cid=col.getStringAttribute("cid");
    updated.add(cid);
    String caption=buildCaptionHtmlSnippet(col);
    HeaderCell c=getHeaderCell(cid);
    if (c == null) {
      c=new HeaderCell(cid,caption);
      availableCells.put(cid,c);
      if (initializedAndAttached) {
        initializedAndAttached=false;
        initialContentReceived=false;
        isNewBody=true;
      }
    }
 else {
      c.setText(caption);
    }
    if (col.hasAttribute("sortable")) {
      c.setSortable(true);
      if (cid.equals(sortColumn)) {
        c.setSorted(true);
      }
 else {
        c.setSorted(false);
      }
    }
    if (col.hasAttribute("align")) {
      c.setAlign(col.getStringAttribute("align").charAt(0));
    }
    if (col.hasAttribute("width")) {
      final String width=col.getStringAttribute("width");
      c.setWidth(Integer.parseInt(width));
    }
 else     if (recalcWidths) {
      c.setWidth(-1);
    }
  }
  for (  String cid : availableCells.keySet()) {
    if (!updated.contains(cid)) {
      removeCell(cid);
      it.remove();
    }
  }
}

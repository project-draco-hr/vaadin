{
  if (event.getName().equals(SESSION_BINDING_LISTENER)) {
    Object[] apps=applications.toArray();
    for (int i=0; i < apps.length; i++) {
      if (apps[i] != null) {
        ((Application)apps[i]).close();
        Object lock=applicationToServerCommandStreamLock.get(apps[i]);
        if (lock != null) synchronized (lock) {
          lock.notifyAll();
        }
        applicationToServerCommandStreamLock.remove(apps[i]);
        applications.remove(apps[i]);
        if (applicationToAjaxAppMgrMap.get((Application)apps[i]) == null) {
          System.out.println("ERROR: tried to remove nonexistent application (" + (Application)apps[i] + ")");
        }
 else {
          applicationToAjaxAppMgrMap.remove((Application)apps[i]);
        }
      }
    }
  }
}

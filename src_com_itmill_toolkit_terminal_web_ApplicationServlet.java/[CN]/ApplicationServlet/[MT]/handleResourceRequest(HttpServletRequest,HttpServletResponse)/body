{
  if (resourcePath == null)   resourcePath=request.getContextPath() + request.getServletPath() + RESOURCE_URI;
  resourcePath=resourcePath.replaceAll("//","/");
  String resourceId=request.getPathInfo();
  if (resourceId == null || !resourceId.startsWith(RESOURCE_URI))   return false;
  resourceId=resourceId.substring(RESOURCE_URI.length());
  InputStream data=null;
  try {
    data=themeSource.getResource(resourceId);
  }
 catch (  ThemeSource.ThemeException e) {
    Log.info(e.getMessage());
    data=null;
  }
  try {
    if (data != null) {
      response.setContentType(FileTypeResolver.getMIMEType(resourceId));
      if (this.themeCacheTime > 0) {
        response.setHeader("Cache-Control","max-age=" + this.themeCacheTime / 1000);
        response.setDateHeader("Expires",System.currentTimeMillis() + this.themeCacheTime);
        response.setHeader("Pragma","cache");
      }
      byte[] buffer=new byte[DEFAULT_BUFFER_SIZE];
      int bytesRead=0;
      OutputStream out=response.getOutputStream();
      while ((bytesRead=data.read(buffer)) > 0) {
        out.write(buffer,0,bytesRead);
      }
      out.close();
      data.close();
    }
 else {
      response.sendError(HttpServletResponse.SC_NOT_FOUND);
    }
  }
 catch (  java.io.IOException e) {
    Log.info("Resource transfer failed:  " + request.getRequestURI() + ". ("+ e.getMessage()+ ")");
  }
  return true;
}

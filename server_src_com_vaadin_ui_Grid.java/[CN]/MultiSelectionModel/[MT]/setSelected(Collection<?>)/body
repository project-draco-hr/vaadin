{
  if (itemIds == null) {
    throw new IllegalArgumentException("itemIds may not be null");
  }
  checkItemIdsExist(itemIds);
  boolean changed=false;
  Set<Object> selectedRows=new HashSet<Object>(itemIds);
  final Collection<Object> oldSelection=getSelectedRows();
  SetView<?> added=Sets.difference(selectedRows,selection);
  if (!added.isEmpty()) {
    changed=true;
    selection.addAll(added.immutableCopy());
  }
  SetView<?> removed=Sets.difference(selection,selectedRows);
  if (!removed.isEmpty()) {
    changed=true;
    selection.removeAll(removed.immutableCopy());
  }
  if (changed) {
    fireSelectionEvent(oldSelection,selection);
  }
  return changed;
}

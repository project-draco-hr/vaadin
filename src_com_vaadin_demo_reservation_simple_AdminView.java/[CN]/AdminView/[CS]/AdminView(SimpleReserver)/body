{
  setWidth("250px");
  application=app;
  resources.setImmediate(true);
  resources.setFilteringMode(ComboBox.FILTERINGMODE_CONTAINS);
  refreshList();
  resources.setItemCaptionMode(ComboBox.ITEM_CAPTION_MODE_PROPERTY);
  resources.setItemCaptionPropertyId(SampleDB.Resource.PROPERTY_ID_NAME);
  resources.setNewItemsAllowed(true);
  resources.setNewItemHandler(new NewItemHandler(){
    public void addNewItem(    String newItemCaption){
      name.setValue(newItemCaption);
      desc.setValue("");
      form.setVisible(true);
    }
  }
);
  resources.addListener(new ComboBox.ValueChangeListener(){
    public void valueChange(    ValueChangeEvent event){
      if (resources.getValue() != null) {
        editedItem=resources.getItem(resources.getValue());
        name.setPropertyDataSource(editedItem.getItemProperty(SampleDB.Resource.PROPERTY_ID_NAME));
        desc.setPropertyDataSource(editedItem.getItemProperty(SampleDB.Resource.PROPERTY_ID_DESCRIPTION));
        form.setVisible(true);
      }
 else {
        form.setVisible(false);
        editedItem=null;
      }
    }
  }
);
  addComponent(resources);
  form.setVisible(false);
  addComponent(form);
  form.addComponent(name);
  form.addComponent(desc);
  name.setWidth("100%");
  desc.setWidth("100%");
  form.addComponent(save);
  save.addListener(new ClickListener(){
    public void buttonClick(    ClickEvent event){
      if (editedItem == null) {
        application.getDb().addResource(name.getValue().toString(),desc.getValue().toString());
      }
 else {
        application.getDb().updateResource(editedItem,name.getValue().toString(),desc.getValue().toString());
      }
      resources.setValue(null);
      refreshList();
    }
  }
);
}

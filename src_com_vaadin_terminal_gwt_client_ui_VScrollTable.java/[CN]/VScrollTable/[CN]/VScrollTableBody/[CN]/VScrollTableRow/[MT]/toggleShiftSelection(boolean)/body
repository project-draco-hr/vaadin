{
  if (selectedRowKeys.isEmpty() || lastSelectedRowKey < 0 || selectMode == SELECT_MODE_SINGLE) {
    deselectAll();
    toggleSelection(true);
    return;
  }
  int startKey=lastSelectedRowKey;
  int endKey=rowKey;
  if (endKey < startKey) {
    startKey^=endKey;
    endKey^=startKey;
    startKey^=endKey;
  }
  if (deselectPrevious) {
    deselectAll();
  }
  for (int r=startKey; r <= endKey; r++) {
    if (r != rowKey) {
      VScrollTableRow row=getRenderedRowByKey(String.valueOf(r));
      if (row != null && !row.isSelected()) {
        row.toggleSelection(false);
        selectedRowKeys.add(String.valueOf(r));
      }
    }
  }
  toggleSelection(false);
  selectedRowRanges.add(new SelectionRange(startKey,endKey));
}

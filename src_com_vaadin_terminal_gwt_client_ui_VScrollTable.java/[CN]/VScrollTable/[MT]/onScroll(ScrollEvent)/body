{
  scrollLeft=bodyContainer.getElement().getScrollLeft();
  scrollTop=bodyContainer.getScrollPosition();
  if (!initializedAndAttached) {
    return;
  }
  if (!enabled) {
    bodyContainer.setScrollPosition(firstRowInViewPort * scrollBody.getRowHeight());
    return;
  }
  rowRequestHandler.cancel();
  if (BrowserInfo.get().isSafari() && event != null && scrollTop == 0) {
    DeferredCommand.addCommand(new Command(){
      public void execute(){
        onScroll(null);
      }
    }
);
    return;
  }
  tHead.setHorizontalScrollPosition(scrollLeft);
  firstRowInViewPort=(int)Math.ceil(scrollTop / (double)scrollBody.getRowHeight());
  if (firstRowInViewPort > totalRows - pageLength) {
    firstRowInViewPort=totalRows - pageLength;
  }
  int postLimit=(int)(firstRowInViewPort + (pageLength - 1) + pageLength * cache_react_rate);
  if (postLimit > totalRows - 1) {
    postLimit=totalRows - 1;
  }
  int preLimit=(int)(firstRowInViewPort - pageLength * cache_react_rate);
  if (preLimit < 0) {
    preLimit=0;
  }
  final int lastRendered=scrollBody.getLastRendered();
  final int firstRendered=scrollBody.getFirstRendered();
  if (postLimit <= lastRendered && preLimit >= firstRendered) {
    lastRequestedFirstvisible=firstRowInViewPort;
    client.updateVariable(paintableId,"firstvisible",firstRowInViewPort,false);
    return;
  }
  if (firstRowInViewPort - pageLength * cache_rate > lastRendered || firstRowInViewPort + pageLength + pageLength * cache_rate < firstRendered) {
    rowRequestHandler.setReqFirstRow((firstRowInViewPort - (int)(pageLength * cache_rate)));
    int last=firstRowInViewPort + (int)(cache_rate * pageLength) + pageLength - 1;
    if (last >= totalRows) {
      last=totalRows - 1;
    }
    rowRequestHandler.setReqRows(last - rowRequestHandler.getReqFirstRow() + 1);
    rowRequestHandler.deferRowFetch();
    return;
  }
  if (preLimit < firstRendered) {
    rowRequestHandler.setReqFirstRow((int)(firstRowInViewPort - pageLength * cache_rate));
    rowRequestHandler.setReqRows(firstRendered - rowRequestHandler.getReqFirstRow());
    rowRequestHandler.deferRowFetch();
    return;
  }
  if (postLimit > lastRendered) {
    rowRequestHandler.setReqFirstRow(lastRendered + 1);
    rowRequestHandler.setReqRows((int)((firstRowInViewPort + pageLength + pageLength * cache_rate) - lastRendered));
    rowRequestHandler.deferRowFetch();
  }
}

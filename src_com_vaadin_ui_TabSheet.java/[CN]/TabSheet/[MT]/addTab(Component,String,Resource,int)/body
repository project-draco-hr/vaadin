{
  if (c == null) {
    return null;
  }
 else   if (tabs.containsKey(c)) {
    Tab tab=tabs.get(c);
    setTabIndex(tab,index);
    tab.setCaption(caption);
    tab.setIcon(icon);
    return tab;
  }
 else {
    components.add(index,c);
    Tab tab=new TabSheetTabImpl(caption,icon);
    tabs.put(c,tab);
    if (selected == null) {
      selected=c;
      fireSelectedTabChange();
    }
    super.addComponent(c);
    requestRepaint();
    return tab;
  }
}

{
  setSizeFull();
  VerticalSplitPanel mainLayout=new VerticalSplitPanel();
  mainLayout.setSplitPosition(30);
  setCompositionRoot(mainLayout);
  table.setSizeFull();
  table.setImmediate(true);
  table.setSelectable(true);
  mainLayout.setFirstComponent(table);
  mainLayout.setSecondComponent(form);
  form.setImmediate(true);
  form.setBuffered(true);
  HorizontalLayout footer=new HorizontalLayout();
  footer.setSpacing(true);
  form.setFooter(footer);
  Button saveButton=new Button("Save");
  footer.addComponent(saveButton);
  saveButton.setClickShortcut(KeyCode.ENTER);
  table.addListener(new ValueChangeListener(){
    @Override public void valueChange(    ValueChangeEvent event){
      Object value=event.getProperty().getValue();
      if (value != null) {
        String fragment="edit/" + String.valueOf(value).replaceAll("[^0-9]","");
        if (!fragment.equals(previousFragment)) {
          navigateTo(fragment);
        }
      }
    }
  }
);
  saveButton.addListener(new ClickListener(){
    @Override public void buttonClick(    ClickEvent event){
      form.commit();
      Topping entity=getEntityForItem(form.getItemDataSource());
      if (entity != null && entity.getId() == null) {
        entity.setId(index++);
        toppings.put(entity.getId(),entity);
      }
      refreshTable();
      navigateTo(null);
    }
  }
);
  refreshTable();
  navigateTo("new");
}

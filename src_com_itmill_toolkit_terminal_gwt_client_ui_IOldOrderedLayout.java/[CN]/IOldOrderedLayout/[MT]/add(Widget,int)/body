{
  if (atIndex < 0 || atIndex > childWidgets.size()) {
    return;
  }
  if (childWidgets.contains(child)) {
    if (childWidgets.indexOf(child) == atIndex) {
      return;
    }
    final int removeFromIndex=childWidgets.indexOf(child);
    final WidgetWrapper wrapper=childWidgetWrappers.get(removeFromIndex);
    Element wrapperElement=wrapper.getElement();
    final int nonWidgetChildElements=DOM.getChildCount(wrappedChildContainer) - childWidgets.size();
    DOM.removeChild(wrappedChildContainer,wrapperElement);
    DOM.insertChild(wrappedChildContainer,wrapperElement,atIndex + nonWidgetChildElements);
    childWidgets.remove(removeFromIndex);
    childWidgetWrappers.remove(removeFromIndex);
    childWidgets.insertElementAt(child,atIndex);
    childWidgetWrappers.insertElementAt(wrapper,atIndex);
    return;
  }
  child.removeFromParent();
  childWidgets.insertElementAt(child,atIndex);
  final WidgetWrapper wrapper=new WidgetWrapper();
  final int nonWidgetChildElements=DOM.getChildCount(wrappedChildContainer) - childWidgetWrappers.size();
  childWidgetWrappers.insertElementAt(wrapper,atIndex);
  DOM.insertChild(wrappedChildContainer,wrapper.getElement(),atIndex + nonWidgetChildElements);
  DOM.appendChild(wrapper.getElementWrappingWidgetAndCaption(),child.getElement());
  adopt(child);
}

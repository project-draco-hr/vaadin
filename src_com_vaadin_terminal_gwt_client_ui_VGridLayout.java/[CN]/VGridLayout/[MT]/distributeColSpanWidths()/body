{
  for (  SpanList list : colSpans) {
    for (    Cell cell : list.cells) {
      int width=cell.hasRelativeWidth() ? 0 : cell.getWidth();
      int allocated=columnWidths[cell.col];
      for (int i=1; i < cell.colspan; i++) {
        allocated+=spacingPixelsHorizontal + columnWidths[cell.col + i];
      }
      if (allocated < width) {
        int neededExtraSpace=width - allocated;
        int spaceForColunms=neededExtraSpace / cell.colspan;
        for (int i=0; i < cell.colspan; i++) {
          int col=cell.col + i;
          columnWidths[col]+=spaceForColunms;
          neededExtraSpace-=spaceForColunms;
        }
        if (neededExtraSpace > 0) {
          for (int i=0; i < cell.colspan; i++) {
            int col=cell.col + i;
            columnWidths[col]+=1;
            neededExtraSpace-=1;
            if (neededExtraSpace == 0) {
              break;
            }
          }
        }
      }
    }
  }
}

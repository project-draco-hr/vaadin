{
  final StringBuffer buf=new StringBuffer();
  Iterator<String> iterator=map.keySet().iterator();
  while (iterator.hasNext()) {
    String key=iterator.next();
    Object value=map.get(key);
    char transportType=getTransportType(value);
    buf.append(transportType);
    buf.append(escapeVariableValue(key));
    buf.append(VAR_ARRAYITEM_SEPARATOR);
    if (transportType == 'p') {
      buf.append(getPid((Paintable)value));
    }
 else {
      buf.append(escapeVariableValue(String.valueOf(value)));
    }
    if (iterator.hasNext()) {
      buf.append(VAR_ARRAYITEM_SEPARATOR);
    }
  }
  addVariableToQueue(paintableId,variableName,buf.toString(),immediate,'m');
}

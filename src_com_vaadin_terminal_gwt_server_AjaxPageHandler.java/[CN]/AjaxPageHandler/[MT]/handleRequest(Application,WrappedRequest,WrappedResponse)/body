{
  int rootId;
  try {
    Root root=application.getRootForRequest(request);
    if (root == null) {
      writeError(response,new Throwable("No Root found"));
      return true;
    }
    rootId=root.getRootId();
  }
 catch (  RootRequiresMoreInformation e) {
    rootId=application.registerPendingRoot(request);
  }
  try {
    writeAjaxPage(request,response,application,rootId);
  }
 catch (  JSONException e) {
    writeError(response,e);
  }
  return true;
}

{
  Application application=context.getApplication();
  int rootId=context.getRootId();
  JSONObject appConfig=new JSONObject();
  appConfig.put(ApplicationConnection.ROOT_ID_PARAMETER,rootId);
  if (context.getThemeName() != null) {
    appConfig.put("themeUri",getThemeUri(context,context.getThemeName()));
  }
  JSONObject versionInfo=new JSONObject();
  versionInfo.put("vaadinVersion",AbstractApplicationServlet.VERSION);
  versionInfo.put("applicationVersion",application.getVersion());
  appConfig.put("versionInfo",versionInfo);
  appConfig.put("widgetset",context.getWidgetsetName());
  if (application.isRootInitPending(rootId)) {
    appConfig.put("initPending",true);
  }
 else {
    appConfig.put("uidl",getInitialUIDL(context.getRequest(),context.getRoot()));
  }
  return appConfig;
}

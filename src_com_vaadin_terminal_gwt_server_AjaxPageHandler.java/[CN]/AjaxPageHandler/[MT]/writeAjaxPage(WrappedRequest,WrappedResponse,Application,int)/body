{
  AjaxPageContext context=createContext(request,response,application,rootId);
  DeploymentConfiguration deploymentConfiguration=request.getDeploymentConfiguration();
  boolean standalone=deploymentConfiguration.isStandalone(request);
  if (standalone) {
    setAjaxPageHeaders(context);
    writeAjaxPageHtmlHeadStart(context);
    writeAjaxPageHtmlHeader(context);
    writeAjaxPageHtmlBodyStart(context);
  }
  writeAjaxPageHtmlVaadinScripts(context);
  writeAjaxPageHtmlMainDiv(context);
  Writer page=context.getWriter();
  if (standalone) {
    page.write("</body>\n</html>\n");
  }
  page.close();
}

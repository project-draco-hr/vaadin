{
  getWidget().client=client;
  super.updateFromUIDL(uidl,client);
  if (!isRealUpdate(uidl)) {
    return;
  }
  getWidget().pid=uidl.getId();
  if (!getWidget().hasTemplate()) {
    getWidget().initializeHTML(uidl,client);
  }
  VCustomLayout.eval(getWidget().scripts);
  getWidget().scripts=null;
  client.runDescendentsLayout(getWidget());
  Set<Widget> oldWidgets=new HashSet<Widget>();
  oldWidgets.addAll(getWidget().locationToWidget.values());
  for (final Iterator<?> i=uidl.getChildIterator(); i.hasNext(); ) {
    final UIDL uidlForChild=(UIDL)i.next();
    if (uidlForChild.getTag().equals("location")) {
      final String location=uidlForChild.getStringAttribute("name");
      UIDL childUIDL=uidlForChild.getChildUIDL(0);
      final ComponentConnector childPaintable=client.getPaintable(childUIDL);
      Widget childWidget=childPaintable.getWidget();
      try {
        getWidget().setWidget(childWidget,location);
        childPaintable.updateFromUIDL(childUIDL,client);
      }
 catch (      final IllegalArgumentException e) {
      }
      oldWidgets.remove(childWidget);
    }
  }
  for (Iterator<Widget> iterator=oldWidgets.iterator(); iterator.hasNext(); ) {
    Widget oldWidget=iterator.next();
    if (oldWidget.isAttached()) {
      getWidget().remove(oldWidget);
    }
  }
  client.runDescendentsLayout(getWidget());
}

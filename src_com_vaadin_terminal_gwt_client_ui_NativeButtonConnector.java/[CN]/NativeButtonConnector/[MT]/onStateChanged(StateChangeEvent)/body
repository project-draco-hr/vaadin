{
  super.onStateChanged(stateChangeEvent);
  getWidget().disableOnClick=getState().isDisableOnClick();
  focusHandlerRegistration=EventHelper.updateFocusHandler(this,focusHandlerRegistration);
  blurHandlerRegistration=EventHelper.updateBlurHandler(this,blurHandlerRegistration);
  getWidget().setText(getState().getCaption());
  if (null != getState().getErrorMessage()) {
    if (getWidget().errorIndicatorElement == null) {
      getWidget().errorIndicatorElement=DOM.createSpan();
      getWidget().errorIndicatorElement.setClassName("v-errorindicator");
    }
    getWidget().getElement().insertBefore(getWidget().errorIndicatorElement,getWidget().captionElement);
  }
 else   if (getWidget().errorIndicatorElement != null) {
    getWidget().getElement().removeChild(getWidget().errorIndicatorElement);
    getWidget().errorIndicatorElement=null;
  }
  if (getState().getIcon() != null) {
    if (getWidget().icon == null) {
      getWidget().icon=new Icon(getConnection());
      getWidget().getElement().insertBefore(getWidget().icon.getElement(),getWidget().captionElement);
    }
    getWidget().icon.setUri(getState().getIcon().getURL());
  }
 else {
    if (getWidget().icon != null) {
      getWidget().getElement().removeChild(getWidget().icon.getElement());
      getWidget().icon=null;
    }
  }
}

{
  Connection c=null;
  PreparedStatement pstmt=null;
  try {
    if (transactionOpen && activeConnection != null) {
      c=activeConnection;
    }
 else {
      c=connectionPool.reserveConnection();
    }
    pstmt=c.prepareStatement(sh.getQueryString());
    sh.setParameterValuesToStatement(pstmt);
    getLogger().log(Level.FINE,"DB -> " + sh.getQueryString());
    int retval=pstmt.executeUpdate();
    return retval;
  }
  finally {
    if (pstmt != null) {
      pstmt.clearParameters();
      pstmt.close();
    }
    if (!transactionOpen) {
      connectionPool.releaseConnection(c);
    }
  }
}

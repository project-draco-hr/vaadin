{
  super.changeVariables(source,variables);
  if (variables.containsKey("text") && !isReadOnly()) {
    String newValue=(String)variables.get("text");
    final String oldValue=getFormattedValue();
    if (newValue != null && (oldValue == null || isNullSettingAllowed()) && newValue.equals(getNullRepresentation())) {
      newValue=null;
    }
    if (newValue != oldValue && (newValue == null || !newValue.equals(oldValue))) {
      boolean wasModified=isModified();
      setValue(newValue,true);
      if (format != null || wasModified != isModified()) {
        requestRepaint();
      }
    }
  }
}

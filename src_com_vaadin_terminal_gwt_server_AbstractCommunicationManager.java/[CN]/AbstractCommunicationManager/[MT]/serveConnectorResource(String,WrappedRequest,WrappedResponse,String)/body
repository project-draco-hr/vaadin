{
  if (resourceName.startsWith("/")) {
    response.sendError(HttpServletResponse.SC_NOT_FOUND,resourceName);
    return;
  }
  Class<?> context;
synchronized (connectoResourceContexts) {
    context=connectoResourceContexts.get(resourceName);
  }
  if (context == null) {
    response.sendError(HttpServletResponse.SC_NOT_FOUND,resourceName);
    return;
  }
  InputStream in=context.getResourceAsStream(resourceName);
  if (in == null) {
    response.sendError(HttpServletResponse.SC_NOT_FOUND,resourceName);
    return;
  }
  OutputStream out=null;
  try {
    if (mimetype != null) {
      response.setContentType(mimetype);
    }
    out=response.getOutputStream();
    final byte[] buffer=new byte[Constants.DEFAULT_BUFFER_SIZE];
    int bytesRead=0;
    while ((bytesRead=in.read(buffer)) > 0) {
      out.write(buffer,0,bytesRead);
    }
    out.flush();
  }
  finally {
    try {
      in.close();
    }
 catch (    Exception e) {
    }
    if (out != null) {
      try {
        out.close();
      }
 catch (      Exception e) {
      }
    }
  }
}

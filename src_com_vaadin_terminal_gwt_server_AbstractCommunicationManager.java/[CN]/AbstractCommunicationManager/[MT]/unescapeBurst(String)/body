{
  final StringBuilder result=new StringBuilder();
  final StringCharacterIterator iterator=new StringCharacterIterator(encodedValue);
  char character=iterator.current();
  while (character != CharacterIterator.DONE) {
    if (VAR_ESCAPE_CHARACTER == character) {
      character=iterator.next();
switch (character) {
case VAR_ESCAPE_CHARACTER + 0x30:
        result.append(VAR_ESCAPE_CHARACTER);
      break;
case VAR_BURST_SEPARATOR + 0x30:
    result.append((char)(character - 0x30));
  break;
case CharacterIterator.DONE:
throw new RuntimeException("Communication error: Unexpected end of message");
default :
throw new RuntimeException("Invalid escaped character from the client - check that the widgetset and server versions match");
}
}
 else {
result.append(character);
}
character=iterator.next();
}
return result.toString();
}

{
  IndexedContainer container=new IndexedContainer();
  ItemSetChangeCounter counter=new ItemSetChangeCounter();
  container.addListener(counter);
  counter.reset();
  container.addContainerFilter(FULLY_QUALIFIED_NAME,"Test",true,false);
  counter.assertNone();
  String id1="com.example.Test1";
  String id2="com.example.Test2";
  String id3="com.example.Other";
  Item item;
  initializeContainer(container);
  counter.reset();
  item=container.addItem(id1);
  counter.assertNone();
  item.getItemProperty(FULLY_QUALIFIED_NAME).setValue(id1);
  counter.assertOnce();
  item=container.addItem(id1);
  counter.assertNone();
  initializeContainer(container);
  counter.reset();
  item=container.addItemAt(0,id1);
  counter.assertNone();
  item.getItemProperty(FULLY_QUALIFIED_NAME).setValue(id1);
  counter.assertOnce();
  item=container.addItemAt(container.size(),id2);
  counter.assertNone();
  item.getItemProperty(FULLY_QUALIFIED_NAME).setValue(id2);
  counter.assertOnce();
  item=container.addItemAt(0,id1);
  counter.assertNone();
  item=container.addItemAt(container.size(),id2);
  counter.assertNone();
  initializeContainer(container);
  counter.reset();
  item=container.addItemAfter(null,id1);
  counter.assertNone();
  item.getItemProperty(FULLY_QUALIFIED_NAME).setValue(id1);
  counter.assertOnce();
  item=container.addItemAfter(container.lastItemId(),id2);
  counter.assertNone();
  item.getItemProperty(FULLY_QUALIFIED_NAME).setValue(id2);
  counter.assertOnce();
  item=container.addItemAfter(null,id1);
  counter.assertNone();
  item=container.addItemAfter(container.lastItemId(),id2);
  counter.assertNone();
  initializeContainer(container);
  counter.reset();
  item=container.addItemAfter(null,id3);
  counter.assertNone();
  item.getItemProperty(FULLY_QUALIFIED_NAME).setValue(id3);
  counter.assertNone();
  initializeContainer(container);
  counter.reset();
  item=container.addItemAfter(container.firstItemId(),id3);
  counter.assertNone();
  item.getItemProperty(FULLY_QUALIFIED_NAME).setValue(id3);
  counter.assertNone();
  initializeContainer(container);
  counter.reset();
  item=container.addItemAfter(container.lastItemId(),id3);
  counter.assertNone();
  item.getItemProperty(FULLY_QUALIFIED_NAME).setValue(id3);
  counter.assertNone();
  initializeContainer(container);
  counter.reset();
  item=container.addItemAt(0,id3);
  counter.assertNone();
  item.getItemProperty(FULLY_QUALIFIED_NAME).setValue(id3);
  counter.assertNone();
  initializeContainer(container);
  counter.reset();
  item=container.addItemAt(1,id3);
  counter.assertNone();
  item.getItemProperty(FULLY_QUALIFIED_NAME).setValue(id3);
  counter.assertNone();
  initializeContainer(container);
  counter.reset();
  item=container.addItemAt(container.size(),id3);
  counter.assertNone();
  item.getItemProperty(FULLY_QUALIFIED_NAME).setValue(id3);
  counter.assertNone();
  initializeContainer(container);
  counter.reset();
  item=container.addItem(id1);
  counter.assertNone();
  item.getItemProperty(FULLY_QUALIFIED_NAME).setValue(id1);
  counter.assertOnce();
  container.removeItem(id1);
  counter.assertOnce();
  container.removeItem(id1);
  counter.assertNone();
  item=container.addItem(id3);
  counter.assertNone();
  item.getItemProperty(FULLY_QUALIFIED_NAME).setValue(id3);
  counter.assertNone();
  container.removeItem(id3);
  counter.assertNone();
  initializeContainer(container);
  item=container.addItem(id1);
  item.getItemProperty(FULLY_QUALIFIED_NAME).setValue(id1);
  counter.reset();
  container.removeAllItems();
  counter.assertOnce();
  container.removeAllItems();
  counter.assertNone();
}

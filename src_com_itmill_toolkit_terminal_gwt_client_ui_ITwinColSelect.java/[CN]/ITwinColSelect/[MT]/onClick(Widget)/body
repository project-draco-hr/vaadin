{
  super.onClick(sender);
  if (sender == add) {
    boolean[] sel=getItemsToAdd();
    for (int i=0; i < sel.length; i++) {
      if (sel[i]) {
        int optionIndex=i - (sel.length - options.getItemCount());
        selectedKeys.add(options.getValue(optionIndex));
        String text=options.getItemText(optionIndex);
        String value=options.getValue(optionIndex);
        selections.addItem(text,value);
        selections.setItemSelected(selections.getItemCount() - 1,true);
        options.removeItem(optionIndex);
      }
    }
    client.updateVariable(id,"selected",selectedKeys.toArray(),isImmediate());
  }
 else   if (sender == remove) {
    boolean[] sel=getItemsToRemove();
    for (int i=0; i < sel.length; i++) {
      if (sel[i]) {
        int selectionIndex=i - (sel.length - selections.getItemCount());
        selectedKeys.remove(selections.getValue(selectionIndex));
        String text=selections.getItemText(selectionIndex);
        String value=selections.getValue(selectionIndex);
        options.addItem(text,value);
        options.setItemSelected(options.getItemCount() - 1,true);
        selections.removeItem(selectionIndex);
      }
    }
    client.updateVariable(id,"selected",selectedKeys.toArray(),isImmediate());
  }
 else   if (sender == options) {
    int c=selections.getItemCount();
    for (int i=0; i < c; i++) {
      selections.setItemSelected(i,false);
    }
  }
 else   if (sender == selections) {
    int c=options.getItemCount();
    for (int i=0; i < c; i++) {
      options.setItemSelected(i,false);
    }
  }
}

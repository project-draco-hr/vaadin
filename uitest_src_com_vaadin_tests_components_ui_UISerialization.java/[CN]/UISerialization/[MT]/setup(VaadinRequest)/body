{
  addComponent(log);
  for (  Class<? extends Component> cls : VaadinClasses.getComponents()) {
    try {
      AbstractComponent c=(AbstractComponent)cls.newInstance();
      if (c instanceof LegacyWindow) {
        continue;
      }
      if (!(c instanceof Button)) {
        continue;
      }
      c.setId(cls.getName());
      c.setCaption(cls.getName());
      c.setDescription(cls.getName());
      c.setWidth("100px");
      c.setHeight("100px");
      addComponent(c);
      System.out.println("Added " + cls.getName());
    }
 catch (    Exception e) {
      System.err.println("Could not instatiate " + cls.getName());
    }
  }
  addComponent(new Button("Serialize UI",new ClickListener(){
    @Override public void buttonClick(    ClickEvent event){
      Date d=new Date();
      byte[] result=serialize(UISerialization.this);
      long elapsed=new Date().getTime() - d.getTime();
      log.log("Serialized UI in " + elapsed + "ms into "+ result.length+ " bytes");
      Object diffStateBefore=getConnectorTracker().getDiffState(UISerialization.this);
      UISerialization app=(UISerialization)deserialize(result);
      log.log("Deserialized UI in " + elapsed + "ms");
      Object diffStateAfter=getConnectorTracker().getDiffState(UISerialization.this);
      if (diffStateBefore.equals(diffStateAfter)) {
        log.log("Diff states match, size: " + diffStateBefore.toString().length());
      }
 else {
        log.log("Diff states do not match");
      }
    }
  }
));
  addComponent(new Button("Instantiate and serialize server classes with no-arg constructors",new ClickListener(){
    @Override public void buttonClick(    ClickEvent event){
      for (      Class<?> cls : VaadinClasses.getAllServerSideClasses()) {
        try {
          serializeInstance(cls);
        }
 catch (        InstantiationException e) {
        }
catch (        Throwable t) {
          log.log("Failed to create and serialize instance of " + cls.getName());
        }
      }
      log.log("Serialization done");
    }
  }
));
}

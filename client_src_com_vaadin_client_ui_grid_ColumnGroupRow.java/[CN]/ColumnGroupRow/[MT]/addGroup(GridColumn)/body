{
  for (  GridColumn column : columns) {
    if (isColumnGrouped(column)) {
      throw new IllegalArgumentException("Column " + String.valueOf(column.getHeaderCaption()) + " already belongs to another group.");
    }
  }
  ColumnGroup group=new ColumnGroup(grid,Arrays.asList(columns));
  groups.add(group);
  grid.refreshHeader();
  grid.refreshFooter();
  return group;
}

def updateRepositories(path):
    global args, repo
    pomXml = join(path, 'pom.xml')
    if isfile(pomXml):
        root = ElementTree.parse(pomXml).getroot()
        nameSpace = root.tag[1:root.tag.index('}')]
        ElementTree.register_namespace('', nameSpace)
        tree = ElementTree.parse(pomXml)
        repoNode = tree.getroot().find(('{%s}repositories' % nameSpace))
    else:
        return
    if (repoNode is not None):
        addRepo(repoNode, 'repository', ('vaadin-%s-staging' % args.version), (repo % args.framework))
        pluginRepo = tree.getroot().find(('{%s}pluginRepositories' % nameSpace))
        if (pluginRepo is None):
            pluginRepo = ElementTree.SubElement(tree.getroot(), 'pluginRepositories')
        addRepo(pluginRepo, 'pluginRepository', ('vaadin-%s-plugin-staging' % args.version), (repo % args.plugin))
        tree.write(pomXml, encoding='UTF-8')
    for i in listdir(path):
        file = join(path, i)
        if isdir(file):
            updateRepositories(join(path, i))

{
  JSONObject jsonMap=new JSONObject();
  for (  Object mapKey : map.keySet()) {
    Object mapValue=map.get(mapKey);
    JSONValue encodedKey=encode(mapKey,restrictToInternalTypes,connectorMap,connection);
    JSONValue encodedValue=encode(mapValue,restrictToInternalTypes,connectorMap,connection);
    jsonMap.put(encodedKey.toString(),encodedValue);
  }
  return combineTypeAndValue(VTYPE_MAP,jsonMap);
}

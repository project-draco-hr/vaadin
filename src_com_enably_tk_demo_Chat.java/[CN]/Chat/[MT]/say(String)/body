{
  Object[] listener;
synchronized (chatters) {
    listener=chatters.toArray();
  }
  for (int i=0; i < listener.length; i++) {
    Chat c=(Chat)((WeakReference)listener[i]).get();
    if (c != null)     c.printToStream(text);
 else     chatters.remove(listener[i]);
  }
  idleSince=(new Date()).getTime();
synchronized (lastMessages) {
    lastMessages.addLast(text);
    while (lastMessages.size() > 5)     lastMessages.removeFirst();
  }
}

{
  VerticalLayout vLayout=new VerticalLayout();
  vLayout.setLocale(Locale.US);
  HorizontalLayout hLayout=new HorizontalLayout();
  hLayout.setLocale(Locale.ITALY);
  vLayout.addComponent(hLayout);
  Button b1=new Button();
  b1.setLocale(Locale.ITALY);
  Button b2=new Button();
  b2.setLocale(Locale.US);
  hLayout.addComponent(b1);
  hLayout.addComponent(b2);
  HorizontalLayout hlayout2=new HorizontalLayout();
  hlayout2.setLocale(Locale.US);
  vLayout.addComponent(hlayout2);
  Label l=new Label();
  l.setLocale(Locale.US);
  hlayout2.addComponent(l);
  Label l2=new Label();
  l2.setLocale(Locale.CANADA);
  hlayout2.addComponent(l2);
  ctx.setComponentRoot(vLayout);
  Document doc=Design.createHtml(ctx);
  Element body=doc.body();
  Element evLayout=body.child(0);
  assertEquals("Wrong locale information.","en_US",evLayout.attr("locale"));
  Element ehLayout=evLayout.child(0);
  assertEquals("Wrong locale information.","it_IT",ehLayout.attr("locale"));
  Element eb1=ehLayout.child(0);
  assertTrue("The element should not have a locale specification, found locale " + eb1.attr("locale"),"".equals(eb1.attr("locale")));
  Element eb2=ehLayout.child(1);
  assertEquals("Wrong locale information.","en_US",eb2.attr("locale"));
  Element ehLayout2=evLayout.child(1);
  assertTrue("The element should not have a locale specification, found locale " + ehLayout2.attr("locale"),"".equals(ehLayout2.attr("locale")));
  Element el1=ehLayout2.child(0);
  assertTrue("The element should not have a locale specification, found locale " + el1.attr("locale"),"".equals(el1.attr("locale")));
  Element el2=ehLayout2.child(1);
  assertEquals("Wrong locale information.","en_CA",el2.attr("locale"));
}

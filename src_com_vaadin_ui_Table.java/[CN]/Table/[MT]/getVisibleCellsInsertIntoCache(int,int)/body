{
  Object[][] cells=getVisibleCellsNoCache(firstIndex,rows,false);
  logger.finest("Insert " + rows + " rows at index "+ firstIndex+ " to existing page buffer with "+ cells.length+ " items");
  int minPageBufferIndex=getCurrentPageFirstItemIndex() - (int)(getPageLength() * getCacheRate());
  if (minPageBufferIndex < 0) {
    minPageBufferIndex=0;
  }
  int maxPageBufferIndex=getCurrentPageFirstItemIndex() + (int)(getPageLength() * (1 + getCacheRate()));
  int maxBufferSize=maxPageBufferIndex - minPageBufferIndex;
  int currentlyCachedRowCount=pageBuffer[CELL_ITEMID].length;
  int firstIndexInPageBuffer=firstIndex - pageBufferFirstIndex;
  int firstCacheRowToRemoveInPageBuffer=firstIndexInPageBuffer;
  int numberOfOldRowsAfterInsertedRows=maxBufferSize - firstIndex - rows;
  if (numberOfOldRowsAfterInsertedRows > 0) {
    firstCacheRowToRemoveInPageBuffer+=numberOfOldRowsAfterInsertedRows;
  }
  if (firstCacheRowToRemoveInPageBuffer <= currentlyCachedRowCount) {
    unregisterComponentsAndPropertiesInRows(firstCacheRowToRemoveInPageBuffer + pageBufferFirstIndex,currentlyCachedRowCount - firstCacheRowToRemoveInPageBuffer + pageBufferFirstIndex);
  }
  int newCachedRowCount=currentlyCachedRowCount;
  if (maxBufferSize == 0 || currentlyCachedRowCount < maxBufferSize) {
    newCachedRowCount=currentlyCachedRowCount + rows;
    if (maxBufferSize > 0 && newCachedRowCount > maxBufferSize) {
      newCachedRowCount=maxBufferSize;
    }
  }
  Object[][] newPageBuffer=new Object[pageBuffer.length][newCachedRowCount];
  for (int ix=0; ix < newCachedRowCount; ix++) {
    for (int i=0; i < pageBuffer.length; i++) {
      if (ix >= firstIndexInPageBuffer && ix < firstIndexInPageBuffer + rows) {
        newPageBuffer[i][ix]=cells[i][ix - firstIndexInPageBuffer];
      }
 else       if (ix >= firstIndexInPageBuffer + rows) {
        newPageBuffer[i][ix]=pageBuffer[i][ix - rows];
      }
 else {
        newPageBuffer[i][ix]=pageBuffer[i][ix];
      }
    }
  }
  pageBuffer=newPageBuffer;
  logger.finest("Page Buffer now contains " + pageBuffer[CELL_ITEMID].length + " rows ("+ pageBufferFirstIndex+ "-"+ (pageBufferFirstIndex + pageBuffer[CELL_ITEMID].length - 1)+ ")");
  return cells;
}

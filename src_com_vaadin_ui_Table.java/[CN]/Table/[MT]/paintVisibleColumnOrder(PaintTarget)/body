{
  final ArrayList<String> visibleColOrder=new ArrayList<String>();
  for (final Iterator<Object> it=visibleColumns.iterator(); it.hasNext(); ) {
    final Object columnId=it.next();
    if (!isColumnCollapsed(columnId)) {
      visibleColOrder.add(columnIdMap.key(columnId));
    }
  }
  target.addAttribute("vcolorder",visibleColOrder.toArray());
}

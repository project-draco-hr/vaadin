{
  if (!isColumnCollapsingAllowed()) {
    throw new IllegalStateException("Column collapsing not allowed!");
  }
  if (collapsed && noncollapsibleColumns.contains(propertyId)) {
    throw new IllegalStateException("The column is noncollapsible!");
  }
  if (collapsed) {
    collapsedColumns.add(propertyId);
  }
 else {
    collapsedColumns.remove(propertyId);
  }
  refreshRowCache();
}

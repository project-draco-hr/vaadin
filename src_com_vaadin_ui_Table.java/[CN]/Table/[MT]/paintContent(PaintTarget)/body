{
  final Set<Action> actionSet=findAndPaintBodyActions(target);
  final Object[][] cells=getVisibleCells();
  int rows=findNumRowsToPaint(target,cells);
  int total=size();
  if (shouldHideNullSelectionItem()) {
    total--;
    rows--;
  }
  paintTableAttributes(target,rows,total);
  paintVisibleColumnOrder(target);
  if (isPartialRowUpdate() && !target.isFullRepaint()) {
    paintPartialRowUpdate(target,actionSet);
  }
 else   if (target.isFullRepaint() || isRowCacheInvalidated()) {
    paintRows(target,cells,actionSet);
    setRowCacheInvalidated(false);
  }
  paintSorting(target);
  resetVariablesAndPageBuffer(target);
  paintActions(target,actionSet);
  paintColumnOrder(target);
  paintAvailableColumns(target);
  paintVisibleColumns(target);
  if (dropHandler != null) {
    dropHandler.getAcceptCriterion().paint(target);
  }
}

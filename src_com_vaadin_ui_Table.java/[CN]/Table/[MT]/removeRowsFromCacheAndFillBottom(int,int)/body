{
  int totalCachedRows=pageBuffer[CELL_ITEMID].length;
  int totalRows=size();
  int cacheIx=firstIndex - pageBufferFirstIndex;
  unregisterComponentsAndPropertiesInRows(firstIndex,rows);
  int newCachedRowCount=totalRows < totalCachedRows ? totalRows : totalCachedRows;
  int firstAppendedRow=newCachedRowCount - rows;
  Object[][] cells=getVisibleCellsNoCache(firstAppendedRow,rows,false);
  Object[][] newPageBuffer=new Object[pageBuffer.length][newCachedRowCount];
  for (int ix=0; ix < newCachedRowCount; ix++) {
    for (int i=0; i < pageBuffer.length; i++) {
      if (ix >= newCachedRowCount - rows) {
        newPageBuffer[i][ix]=cells[i][ix - (newCachedRowCount - rows)];
      }
 else       if (ix >= cacheIx) {
        newPageBuffer[i][ix]=pageBuffer[i][ix + rows];
      }
 else {
        newPageBuffer[i][ix]=pageBuffer[i][ix];
      }
    }
  }
  pageBuffer=newPageBuffer;
}

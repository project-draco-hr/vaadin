{
  DivElement gridElement=DivElement.as(grid.getElement());
  scrollHandler=grid.addScrollHandler(new ScrollHandler(){
    @Override public void onScroll(    ScrollEvent event){
      updateHorizontalScrollPosition();
      if (!isBuffered()) {
        updateVerticalScrollPosition();
      }
    }
  }
);
  gridElement.appendChild(editorOverlay);
  editorOverlay.appendChild(cellWrapper);
  editorOverlay.appendChild(messageAndButtonsWrapper);
  for (int i=0; i < tr.getCells().getLength(); i++) {
    Element cell=createCell(tr.getCells().getItem(i));
    cellWrapper.appendChild(cell);
    Column<?,T> column=grid.getVisibleColumn(i);
    if (column.isEditable()) {
      Widget editor=getHandler().getWidget(column);
      if (editor != null) {
        columnToWidget.put(column,editor);
        attachWidget(editor,cell);
      }
    }
  }
  if (!messageAndButtonsWrapper.isOrHasChild(messageWrapper)) {
    messageAndButtonsWrapper.appendChild(messageWrapper);
    messageAndButtonsWrapper.appendChild(buttonsWrapper);
  }
  if (isBuffered()) {
    attachWidget(saveButton,buttonsWrapper);
    attachWidget(cancelButton,buttonsWrapper);
  }
  updateHorizontalScrollPosition();
  AbstractRowContainer body=(AbstractRowContainer)grid.getEscalator().getBody();
  double rowTop=body.getRowTop(tr);
  int bodyTop=body.getElement().getAbsoluteTop();
  int gridTop=gridElement.getAbsoluteTop();
  double overlayTop=rowTop + bodyTop - gridTop;
  originalScrollTop=grid.getScrollTop();
  if (!isBuffered() || buttonsShouldBeRenderedBelow(tr)) {
    editorOverlay.getStyle().setTop(overlayTop,Unit.PX);
    originalTop=overlayTop;
    editorOverlay.getStyle().clearBottom();
  }
 else {
    editorOverlay.appendChild(cellWrapper);
    int gridHeight=grid.getElement().getOffsetHeight();
    editorOverlay.getStyle().setBottom(gridHeight - overlayTop - tr.getOffsetHeight(),Unit.PX);
    editorOverlay.getStyle().clearTop();
  }
  editorOverlay.getStyle().setWidth(grid.escalator.getInnerWidth(),Unit.PX);
}

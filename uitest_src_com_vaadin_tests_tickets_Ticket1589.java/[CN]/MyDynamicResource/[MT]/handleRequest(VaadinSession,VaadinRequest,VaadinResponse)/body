{
  String relativeUri=request.getPathInfo();
  if (!relativeUri.startsWith("myresource")) {
    return false;
  }
  BufferedImage image=new BufferedImage(200,200,BufferedImage.TYPE_INT_RGB);
  Graphics drawable=image.getGraphics();
  drawable.setColor(Color.lightGray);
  drawable.fillRect(0,0,200,200);
  drawable.setColor(Color.yellow);
  drawable.fillOval(25,25,150,150);
  drawable.setColor(Color.blue);
  drawable.drawRect(0,0,199,199);
  drawable.setColor(Color.black);
  drawable.drawString("Time: " + textToDisplay,75,100);
  try {
    ByteArrayOutputStream imagebuffer=new ByteArrayOutputStream();
    ImageIO.write(image,"png",imagebuffer);
    ByteArrayInputStream istream=new ByteArrayInputStream(imagebuffer.toByteArray());
    DownloadStream downloadStream=new DownloadStream(istream,"image/png","generatedFile.png");
    if (relativeUri.startsWith("myresource_download")) {
      downloadStream.setParameter("Content-Disposition","attachment; filename=\"downloadedPNG.png\"");
    }
    downloadStream.writeResponse(request,response);
    return true;
  }
 catch (  IOException e) {
    return false;
  }
}
